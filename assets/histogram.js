import util from 'assets/util'

const histogram = {
  interpolation: {
    LINEAR: 0,
    SPHERICAL: 1,
    ONE: 2
  },
  range: {
    BLACK: 0,
    DARK: 1,
    MID: 2,
    LIGHT: 3,
    WHITE: 4
  },
  factors: [
    // Linear
    [
      // Mid
      // [0, 0.007874015748031496, 0.015748031496062992, 0.023622047244094488, 0.031496062992125984, 0.03937007874015748, 0.047244094488188976, 0.05511811023622047, 0.06299212598425197, 0.07086614173228346, 0.07874015748031496, 0.08661417322834646, 0.09448818897637795, 0.10236220472440945, 0.11023622047244094, 0.11811023622047244, 0.12598425196850394, 0.13385826771653545, 0.14173228346456693, 0.14960629921259844, 0.15748031496062992, 0.16535433070866143, 0.1732283464566929, 0.18110236220472442, 0.1889763779527559, 0.1968503937007874, 0.2047244094488189, 0.2125984251968504, 0.2204724409448819, 0.2283464566929134, 0.23622047244094488, 0.2440944881889764, 0.25196850393700787, 0.25984251968503935, 0.2677165354330709, 0.2755905511811024, 0.28346456692913385, 0.29133858267716534, 0.2992125984251969, 0.30708661417322836, 0.31496062992125984, 0.3228346456692913, 0.33070866141732286, 0.33858267716535434, 0.3464566929133858, 0.3543307086614173, 0.36220472440944884, 0.3700787401574803, 0.3779527559055118, 0.3858267716535433, 0.3937007874015748, 0.4015748031496063, 0.4094488188976378, 0.41732283464566927, 0.4251968503937008, 0.4330708661417323, 0.4409448818897638, 0.44881889763779526, 0.4566929133858268, 0.4645669291338583, 0.47244094488188976, 0.48031496062992124, 0.4881889763779528, 0.49606299212598426, 0.5039370078740157, 0.5118110236220472, 0.5196850393700787, 0.5275590551181102, 0.5354330708661418, 0.5433070866141733, 0.5511811023622047, 0.5590551181102362, 0.5669291338582677, 0.5748031496062992, 0.5826771653543307, 0.5905511811023622, 0.5984251968503937, 0.6062992125984252, 0.6141732283464567, 0.6220472440944882, 0.6299212598425197, 0.6377952755905512, 0.6456692913385826, 0.6535433070866141, 0.6614173228346457, 0.6692913385826772, 0.6771653543307087, 0.6850393700787402, 0.6929133858267716, 0.7007874015748031, 0.7086614173228346, 0.7165354330708661, 0.7244094488188977, 0.7322834645669292, 0.7401574803149606, 0.7480314960629921, 0.7559055118110236, 0.7637795275590551, 0.7716535433070866, 0.7795275590551181, 0.7874015748031497, 0.7952755905511811, 0.8031496062992126, 0.8110236220472441, 0.8188976377952756, 0.8267716535433071, 0.8346456692913385, 0.84251968503937, 0.8503937007874016, 0.8582677165354331, 0.8661417322834646, 0.8740157480314961, 0.8818897637795275, 0.889763779527559, 0.8976377952755905, 0.905511811023622, 0.9133858267716536, 0.9212598425196851, 0.9291338582677166, 0.937007874015748, 0.9448818897637795, 0.952755905511811, 0.9606299212598425, 0.968503937007874, 0.9763779527559056, 0.984251968503937, 0.9921259842519685, 1, 1, 0.9921259842519685, 0.984251968503937, 0.9763779527559056, 0.968503937007874, 0.9606299212598425, 0.952755905511811, 0.9448818897637795, 0.937007874015748, 0.9291338582677166, 0.9212598425196851, 0.9133858267716536, 0.905511811023622, 0.8976377952755905, 0.889763779527559, 0.8818897637795275, 0.8740157480314961, 0.8661417322834646, 0.8582677165354331, 0.8503937007874016, 0.84251968503937, 0.8346456692913385, 0.8267716535433071, 0.8188976377952756, 0.8110236220472441, 0.8031496062992126, 0.7952755905511811, 0.7874015748031497, 0.7795275590551181, 0.7716535433070866, 0.7637795275590551, 0.7559055118110236, 0.7480314960629921, 0.7401574803149606, 0.7322834645669292, 0.7244094488188977, 0.7165354330708661, 0.7086614173228346, 0.7007874015748031, 0.6929133858267716, 0.6850393700787402, 0.6771653543307087, 0.6692913385826772, 0.6614173228346457, 0.6535433070866141, 0.6456692913385826, 0.6377952755905512, 0.6299212598425197, 0.6220472440944882, 0.6141732283464567, 0.6062992125984252, 0.5984251968503937, 0.5905511811023622, 0.5826771653543307, 0.5748031496062992, 0.5669291338582677, 0.5590551181102362, 0.5511811023622047, 0.5433070866141733, 0.5354330708661418, 0.5275590551181102, 0.5196850393700787, 0.5118110236220472, 0.5039370078740157, 0.49606299212598426, 0.4881889763779528, 0.48031496062992124, 0.47244094488188976, 0.4645669291338583, 0.4566929133858268, 0.44881889763779526, 0.4409448818897638, 0.4330708661417323, 0.4251968503937008, 0.41732283464566927, 0.4094488188976378, 0.4015748031496063, 0.3937007874015748, 0.3858267716535433, 0.3779527559055118, 0.3700787401574803, 0.36220472440944884, 0.3543307086614173, 0.3464566929133858, 0.33858267716535434, 0.33070866141732286, 0.3228346456692913, 0.31496062992125984, 0.30708661417322836, 0.2992125984251969, 0.29133858267716534, 0.28346456692913385, 0.2755905511811024, 0.2677165354330709, 0.25984251968503935, 0.25196850393700787, 0.2440944881889764, 0.23622047244094488, 0.2283464566929134, 0.2204724409448819, 0.2125984251968504, 0.2047244094488189, 0.1968503937007874, 0.1889763779527559, 0.18110236220472442, 0.1732283464566929, 0.16535433070866143, 0.15748031496062992, 0.14960629921259844, 0.14173228346456693, 0.13385826771653545, 0.12598425196850394, 0.11811023622047244, 0.11023622047244094, 0.10236220472440945, 0.09448818897637795, 0.08661417322834646, 0.07874015748031496, 0.07086614173228346, 0.06299212598425197, 0.05511811023622047, 0.047244094488188976, 0.03937007874015748, 0.031496062992125984, 0.023622047244094488, 0.015748031496062992, 0.007874015748031496, 0],
      [0, 0.007874015748031496, 0.015748031496062992, 0.023622047244094488, 0.031496062992125984, 0.03937007874015748, 0.047244094488188976, 0.05511811023622047, 0.06299212598425197, 0.07086614173228346, 0.07874015748031496, 0.08661417322834646, 0.09448818897637795, 0.10236220472440945, 0.11023622047244094, 0.11811023622047244, 0.12598425196850394, 0.13385826771653545, 0.14173228346456693, 0.14960629921259844, 0.15748031496062992, 0.16535433070866143, 0.1732283464566929, 0.18110236220472442, 0.1889763779527559, 0.1968503937007874, 0.2047244094488189, 0.2125984251968504, 0.2204724409448819, 0.2283464566929134, 0.23622047244094488, 0.2440944881889764, 0.25196850393700787, 0.25984251968503935, 0.2677165354330709, 0.2755905511811024, 0.28346456692913385, 0.29133858267716534, 0.2992125984251969, 0.30708661417322836, 0.31496062992125984, 0.3228346456692913, 0.33070866141732286, 0.33858267716535434, 0.3464566929133858, 0.3543307086614173, 0.36220472440944884, 0.3700787401574803, 0.3779527559055118, 0.3858267716535433, 0.3937007874015748, 0.4015748031496063, 0.4094488188976378, 0.41732283464566927, 0.4251968503937008, 0.4330708661417323, 0.4409448818897638, 0.44881889763779526, 0.4566929133858268, 0.4645669291338583, 0.47244094488188976, 0.48031496062992124, 0.4881889763779528, 0.49606299212598426, 0.5039370078740157, 0.5118110236220472, 0.5196850393700787, 0.5275590551181102, 0.5354330708661418, 0.5433070866141733, 0.5511811023622047, 0.5590551181102362, 0.5669291338582677, 0.5748031496062992, 0.5826771653543307, 0.5905511811023622, 0.5984251968503937, 0.6062992125984252, 0.6141732283464567, 0.6220472440944882, 0.6299212598425197, 0.6377952755905512, 0.6456692913385826, 0.6535433070866141, 0.6614173228346457, 0.6692913385826772, 0.6771653543307087, 0.6850393700787402, 0.6929133858267716, 0.7007874015748031, 0.7086614173228346, 0.7165354330708661, 0.7244094488188977, 0.7322834645669292, 0.7401574803149606, 0.7480314960629921, 0.7559055118110236, 0.7637795275590551, 0.7716535433070866, 0.7795275590551181, 0.7874015748031497, 0.7952755905511811, 0.8031496062992126, 0.8110236220472441, 0.8188976377952756, 0.8267716535433071, 0.8346456692913385, 0.84251968503937, 0.8503937007874016, 0.8582677165354331, 0.8661417322834646, 0.8740157480314961, 0.8818897637795275, 0.889763779527559, 0.8976377952755905, 0.905511811023622, 0.9133858267716536, 0.9212598425196851, 0.9291338582677166, 0.937007874015748, 0.9448818897637795, 0.952755905511811, 0.9606299212598425, 0.968503937007874, 0.9763779527559056, 0.984251968503937, 0.9921259842519685, 1, 1, 0.9921259842519685, 0.984251968503937, 0.9763779527559056, 0.968503937007874, 0.9606299212598425, 0.952755905511811, 0.9448818897637795, 0.937007874015748, 0.9291338582677166, 0.9212598425196851, 0.9133858267716536, 0.905511811023622, 0.8976377952755905, 0.889763779527559, 0.8818897637795275, 0.8740157480314961, 0.8661417322834646, 0.8582677165354331, 0.8503937007874016, 0.84251968503937, 0.8346456692913385, 0.8267716535433071, 0.8188976377952756, 0.8110236220472441, 0.8031496062992126, 0.7952755905511811, 0.7874015748031497, 0.7795275590551181, 0.7716535433070866, 0.7637795275590551, 0.7559055118110236, 0.7480314960629921, 0.7401574803149606, 0.7322834645669292, 0.7244094488188977, 0.7165354330708661, 0.7086614173228346, 0.7007874015748031, 0.6929133858267716, 0.6850393700787402, 0.6771653543307087, 0.6692913385826772, 0.6614173228346457, 0.6535433070866141, 0.6456692913385826, 0.6377952755905512, 0.6299212598425197, 0.6220472440944882, 0.6141732283464567, 0.6062992125984252, 0.5984251968503937, 0.5905511811023622, 0.5826771653543307, 0.5748031496062992, 0.5669291338582677, 0.5590551181102362, 0.5511811023622047, 0.5433070866141733, 0.5354330708661418, 0.5275590551181102, 0.5196850393700787, 0.5118110236220472, 0.5039370078740157, 0.49606299212598426, 0.4881889763779528, 0.48031496062992124, 0.47244094488188976, 0.4645669291338583, 0.4566929133858268, 0.44881889763779526, 0.4409448818897638, 0.4330708661417323, 0.4251968503937008, 0.41732283464566927, 0.4094488188976378, 0.4015748031496063, 0.3937007874015748, 0.3858267716535433, 0.3779527559055118, 0.3700787401574803, 0.36220472440944884, 0.3543307086614173, 0.3464566929133858, 0.33858267716535434, 0.33070866141732286, 0.3228346456692913, 0.31496062992125984, 0.30708661417322836, 0.2992125984251969, 0.29133858267716534, 0.28346456692913385, 0.2755905511811024, 0.2677165354330709, 0.25984251968503935, 0.25196850393700787, 0.2440944881889764, 0.23622047244094488, 0.2283464566929134, 0.2204724409448819, 0.2125984251968504, 0.2047244094488189, 0.1968503937007874, 0.1889763779527559, 0.18110236220472442, 0.1732283464566929, 0.16535433070866143, 0.15748031496062992, 0.14960629921259844, 0.14173228346456693, 0.13385826771653545, 0.12598425196850394, 0.11811023622047244, 0.11023622047244094, 0.10236220472440945, 0.09448818897637795, 0.08661417322834646, 0.07874015748031496, 0.07086614173228346, 0.06299212598425197, 0.05511811023622047, 0.047244094488188976, 0.03937007874015748, 0.031496062992125984, 0.023622047244094488, 0.015748031496062992, 0.007874015748031496, 0],
      [0, 0.007874015748031496, 0.015748031496062992, 0.023622047244094488, 0.031496062992125984, 0.03937007874015748, 0.047244094488188976, 0.05511811023622047, 0.06299212598425197, 0.07086614173228346, 0.07874015748031496, 0.08661417322834646, 0.09448818897637795, 0.10236220472440945, 0.11023622047244094, 0.11811023622047244, 0.12598425196850394, 0.13385826771653545, 0.14173228346456693, 0.14960629921259844, 0.15748031496062992, 0.16535433070866143, 0.1732283464566929, 0.18110236220472442, 0.1889763779527559, 0.1968503937007874, 0.2047244094488189, 0.2125984251968504, 0.2204724409448819, 0.2283464566929134, 0.23622047244094488, 0.2440944881889764, 0.25196850393700787, 0.25984251968503935, 0.2677165354330709, 0.2755905511811024, 0.28346456692913385, 0.29133858267716534, 0.2992125984251969, 0.30708661417322836, 0.31496062992125984, 0.3228346456692913, 0.33070866141732286, 0.33858267716535434, 0.3464566929133858, 0.3543307086614173, 0.36220472440944884, 0.3700787401574803, 0.3779527559055118, 0.3858267716535433, 0.3937007874015748, 0.4015748031496063, 0.4094488188976378, 0.41732283464566927, 0.4251968503937008, 0.4330708661417323, 0.4409448818897638, 0.44881889763779526, 0.4566929133858268, 0.4645669291338583, 0.47244094488188976, 0.48031496062992124, 0.4881889763779528, 0.49606299212598426, 0.5039370078740157, 0.5118110236220472, 0.5196850393700787, 0.5275590551181102, 0.5354330708661418, 0.5433070866141733, 0.5511811023622047, 0.5590551181102362, 0.5669291338582677, 0.5748031496062992, 0.5826771653543307, 0.5905511811023622, 0.5984251968503937, 0.6062992125984252, 0.6141732283464567, 0.6220472440944882, 0.6299212598425197, 0.6377952755905512, 0.6456692913385826, 0.6535433070866141, 0.6614173228346457, 0.6692913385826772, 0.6771653543307087, 0.6850393700787402, 0.6929133858267716, 0.7007874015748031, 0.7086614173228346, 0.7165354330708661, 0.7244094488188977, 0.7322834645669292, 0.7401574803149606, 0.7480314960629921, 0.7559055118110236, 0.7637795275590551, 0.7716535433070866, 0.7795275590551181, 0.7874015748031497, 0.7952755905511811, 0.8031496062992126, 0.8110236220472441, 0.8188976377952756, 0.8267716535433071, 0.8346456692913385, 0.84251968503937, 0.8503937007874016, 0.8582677165354331, 0.8661417322834646, 0.8740157480314961, 0.8818897637795275, 0.889763779527559, 0.8976377952755905, 0.905511811023622, 0.9133858267716536, 0.9212598425196851, 0.9291338582677166, 0.937007874015748, 0.9448818897637795, 0.952755905511811, 0.9606299212598425, 0.968503937007874, 0.9763779527559056, 0.984251968503937, 0.9921259842519685, 1, 1, 0.9921259842519685, 0.984251968503937, 0.9763779527559056, 0.968503937007874, 0.9606299212598425, 0.952755905511811, 0.9448818897637795, 0.937007874015748, 0.9291338582677166, 0.9212598425196851, 0.9133858267716536, 0.905511811023622, 0.8976377952755905, 0.889763779527559, 0.8818897637795275, 0.8740157480314961, 0.8661417322834646, 0.8582677165354331, 0.8503937007874016, 0.84251968503937, 0.8346456692913385, 0.8267716535433071, 0.8188976377952756, 0.8110236220472441, 0.8031496062992126, 0.7952755905511811, 0.7874015748031497, 0.7795275590551181, 0.7716535433070866, 0.7637795275590551, 0.7559055118110236, 0.7480314960629921, 0.7401574803149606, 0.7322834645669292, 0.7244094488188977, 0.7165354330708661, 0.7086614173228346, 0.7007874015748031, 0.6929133858267716, 0.6850393700787402, 0.6771653543307087, 0.6692913385826772, 0.6614173228346457, 0.6535433070866141, 0.6456692913385826, 0.6377952755905512, 0.6299212598425197, 0.6220472440944882, 0.6141732283464567, 0.6062992125984252, 0.5984251968503937, 0.5905511811023622, 0.5826771653543307, 0.5748031496062992, 0.5669291338582677, 0.5590551181102362, 0.5511811023622047, 0.5433070866141733, 0.5354330708661418, 0.5275590551181102, 0.5196850393700787, 0.5118110236220472, 0.5039370078740157, 0.49606299212598426, 0.4881889763779528, 0.48031496062992124, 0.47244094488188976, 0.4645669291338583, 0.4566929133858268, 0.44881889763779526, 0.4409448818897638, 0.4330708661417323, 0.4251968503937008, 0.41732283464566927, 0.4094488188976378, 0.4015748031496063, 0.3937007874015748, 0.3858267716535433, 0.3779527559055118, 0.3700787401574803, 0.36220472440944884, 0.3543307086614173, 0.3464566929133858, 0.33858267716535434, 0.33070866141732286, 0.3228346456692913, 0.31496062992125984, 0.30708661417322836, 0.2992125984251969, 0.29133858267716534, 0.28346456692913385, 0.2755905511811024, 0.2677165354330709, 0.25984251968503935, 0.25196850393700787, 0.2440944881889764, 0.23622047244094488, 0.2283464566929134, 0.2204724409448819, 0.2125984251968504, 0.2047244094488189, 0.1968503937007874, 0.1889763779527559, 0.18110236220472442, 0.1732283464566929, 0.16535433070866143, 0.15748031496062992, 0.14960629921259844, 0.14173228346456693, 0.13385826771653545, 0.12598425196850394, 0.11811023622047244, 0.11023622047244094, 0.10236220472440945, 0.09448818897637795, 0.08661417322834646, 0.07874015748031496, 0.07086614173228346, 0.06299212598425197, 0.05511811023622047, 0.047244094488188976, 0.03937007874015748, 0.031496062992125984, 0.023622047244094488, 0.015748031496062992, 0.007874015748031496, 0],
      [0.5019607843137255, 0.5058823529411764, 0.5098039215686274, 0.5137254901960784, 0.5176470588235295, 0.5215686274509804, 0.5254901960784314, 0.5294117647058824, 0.5333333333333333, 0.5372549019607843, 0.5411764705882353, 0.5450980392156862, 0.5490196078431373, 0.5529411764705883, 0.5568627450980392, 0.5607843137254902, 0.5647058823529412, 0.5686274509803921, 0.5725490196078431, 0.5764705882352941, 0.5803921568627451, 0.5843137254901961, 0.5882352941176471, 0.592156862745098, 0.596078431372549, 0.6, 0.6039215686274509, 0.6078431372549019, 0.611764705882353, 0.615686274509804, 0.6196078431372549, 0.6235294117647059, 0.6274509803921569, 0.6313725490196078, 0.6352941176470588, 0.6392156862745098, 0.6431372549019608, 0.6470588235294118, 0.6509803921568628, 0.6549019607843137, 0.6588235294117647, 0.6627450980392157, 0.6666666666666666, 0.6705882352941176, 0.6745098039215687, 0.6784313725490196, 0.6823529411764706, 0.6862745098039216, 0.6901960784313725, 0.6941176470588235, 0.6980392156862745, 0.7019607843137254, 0.7058823529411765, 0.7098039215686275, 0.7137254901960784, 0.7176470588235294, 0.7215686274509804, 0.7254901960784313, 0.7294117647058823, 0.7333333333333333, 0.7372549019607844, 0.7411764705882353, 0.7450980392156863, 0.7490196078431373, 0.7529411764705882, 0.7568627450980392, 0.7607843137254902, 0.7647058823529411, 0.7686274509803922, 0.7725490196078432, 0.7764705882352941, 0.7803921568627451, 0.7843137254901961, 0.788235294117647, 0.792156862745098, 0.796078431372549, 0.8, 0.803921568627451, 0.807843137254902, 0.8117647058823529, 0.8156862745098039, 0.8196078431372549, 0.8235294117647058, 0.8274509803921568, 0.8313725490196079, 0.8352941176470589, 0.8392156862745098, 0.8431372549019608, 0.8470588235294118, 0.8509803921568627, 0.8549019607843137, 0.8588235294117647, 0.8627450980392157, 0.8666666666666667, 0.8705882352941177, 0.8745098039215686, 0.8784313725490196, 0.8823529411764706, 0.8862745098039215, 0.8901960784313725, 0.8941176470588236, 0.8980392156862745, 0.9019607843137255, 0.9058823529411765, 0.9098039215686274, 0.9137254901960784, 0.9176470588235294, 0.9215686274509803, 0.9254901960784314, 0.9294117647058824, 0.9333333333333333, 0.9372549019607843, 0.9411764705882353, 0.9450980392156862, 0.9490196078431372, 0.9529411764705882, 0.9568627450980393, 0.9607843137254902, 0.9647058823529412, 0.9686274509803922, 0.9725490196078431, 0.9764705882352941, 0.9803921568627451, 0.984313725490196, 0.9882352941176471, 0.9921568627450981, 0.996078431372549, 1, 1, 0.996078431372549, 0.9921568627450981, 0.9882352941176471, 0.984313725490196, 0.9803921568627451, 0.9764705882352941, 0.9725490196078431, 0.9686274509803922, 0.9647058823529412, 0.9607843137254902, 0.9568627450980393, 0.9529411764705882, 0.9490196078431372, 0.9450980392156862, 0.9411764705882353, 0.9372549019607843, 0.9333333333333333, 0.9294117647058824, 0.9254901960784314, 0.9215686274509803, 0.9176470588235294, 0.9137254901960784, 0.9098039215686274, 0.9058823529411765, 0.9019607843137255, 0.8980392156862745, 0.8941176470588236, 0.8901960784313725, 0.8862745098039215, 0.8823529411764706, 0.8784313725490196, 0.8745098039215686, 0.8705882352941177, 0.8666666666666667, 0.8627450980392157, 0.8588235294117647, 0.8549019607843137, 0.8509803921568627, 0.8470588235294118, 0.8431372549019608, 0.8392156862745098, 0.8352941176470589, 0.8313725490196079, 0.8274509803921568, 0.8235294117647058, 0.8196078431372549, 0.8156862745098039, 0.8117647058823529, 0.807843137254902, 0.803921568627451, 0.8, 0.796078431372549, 0.792156862745098, 0.788235294117647, 0.7843137254901961, 0.7803921568627451, 0.7764705882352941, 0.7725490196078432, 0.7686274509803922, 0.7647058823529411, 0.7607843137254902, 0.7568627450980392, 0.7529411764705882, 0.7490196078431373, 0.7450980392156863, 0.7411764705882353, 0.7372549019607844, 0.7333333333333333, 0.7294117647058823, 0.7254901960784313, 0.7215686274509804, 0.7176470588235294, 0.7137254901960784, 0.7098039215686275, 0.7058823529411765, 0.7019607843137254, 0.6980392156862745, 0.6941176470588235, 0.6901960784313725, 0.6862745098039216, 0.6823529411764706, 0.6784313725490196, 0.6745098039215687, 0.6705882352941176, 0.6666666666666666, 0.6627450980392157, 0.6588235294117647, 0.6549019607843137, 0.6509803921568628, 0.6470588235294118, 0.6431372549019608, 0.6392156862745098, 0.6352941176470588, 0.6313725490196078, 0.6274509803921569, 0.6235294117647059, 0.6196078431372549, 0.615686274509804, 0.611764705882353, 0.6078431372549019, 0.6039215686274509, 0.6, 0.596078431372549, 0.592156862745098, 0.5882352941176471, 0.5843137254901961, 0.5803921568627451, 0.5764705882352941, 0.5725490196078431, 0.5686274509803921, 0.5647058823529412, 0.5607843137254902, 0.5568627450980392, 0.5529411764705883, 0.5490196078431373, 0.5450980392156862, 0.5411764705882353, 0.5372549019607843, 0.5333333333333333, 0.5294117647058824, 0.5254901960784314, 0.5215686274509804, 0.5176470588235295, 0.5137254901960784, 0.5098039215686274, 0.5058823529411764, 0.5019607843137255],
      [0, 0.007874015748031496, 0.015748031496062992, 0.023622047244094488, 0.031496062992125984, 0.03937007874015748, 0.047244094488188976, 0.05511811023622047, 0.06299212598425197, 0.07086614173228346, 0.07874015748031496, 0.08661417322834646, 0.09448818897637795, 0.10236220472440945, 0.11023622047244094, 0.11811023622047244, 0.12598425196850394, 0.13385826771653545, 0.14173228346456693, 0.14960629921259844, 0.15748031496062992, 0.16535433070866143, 0.1732283464566929, 0.18110236220472442, 0.1889763779527559, 0.1968503937007874, 0.2047244094488189, 0.2125984251968504, 0.2204724409448819, 0.2283464566929134, 0.23622047244094488, 0.2440944881889764, 0.25196850393700787, 0.25984251968503935, 0.2677165354330709, 0.2755905511811024, 0.28346456692913385, 0.29133858267716534, 0.2992125984251969, 0.30708661417322836, 0.31496062992125984, 0.3228346456692913, 0.33070866141732286, 0.33858267716535434, 0.3464566929133858, 0.3543307086614173, 0.36220472440944884, 0.3700787401574803, 0.3779527559055118, 0.3858267716535433, 0.3937007874015748, 0.4015748031496063, 0.4094488188976378, 0.41732283464566927, 0.4251968503937008, 0.4330708661417323, 0.4409448818897638, 0.44881889763779526, 0.4566929133858268, 0.4645669291338583, 0.47244094488188976, 0.48031496062992124, 0.4881889763779528, 0.49606299212598426, 0.5039370078740157, 0.5118110236220472, 0.5196850393700787, 0.5275590551181102, 0.5354330708661418, 0.5433070866141733, 0.5511811023622047, 0.5590551181102362, 0.5669291338582677, 0.5748031496062992, 0.5826771653543307, 0.5905511811023622, 0.5984251968503937, 0.6062992125984252, 0.6141732283464567, 0.6220472440944882, 0.6299212598425197, 0.6377952755905512, 0.6456692913385826, 0.6535433070866141, 0.6614173228346457, 0.6692913385826772, 0.6771653543307087, 0.6850393700787402, 0.6929133858267716, 0.7007874015748031, 0.7086614173228346, 0.7165354330708661, 0.7244094488188977, 0.7322834645669292, 0.7401574803149606, 0.7480314960629921, 0.7559055118110236, 0.7637795275590551, 0.7716535433070866, 0.7795275590551181, 0.7874015748031497, 0.7952755905511811, 0.8031496062992126, 0.8110236220472441, 0.8188976377952756, 0.8267716535433071, 0.8346456692913385, 0.84251968503937, 0.8503937007874016, 0.8582677165354331, 0.8661417322834646, 0.8740157480314961, 0.8818897637795275, 0.889763779527559, 0.8976377952755905, 0.905511811023622, 0.9133858267716536, 0.9212598425196851, 0.9291338582677166, 0.937007874015748, 0.9448818897637795, 0.952755905511811, 0.9606299212598425, 0.968503937007874, 0.9763779527559056, 0.984251968503937, 0.9921259842519685, 1, 1, 0.9921259842519685, 0.984251968503937, 0.9763779527559056, 0.968503937007874, 0.9606299212598425, 0.952755905511811, 0.9448818897637795, 0.937007874015748, 0.9291338582677166, 0.9212598425196851, 0.9133858267716536, 0.905511811023622, 0.8976377952755905, 0.889763779527559, 0.8818897637795275, 0.8740157480314961, 0.8661417322834646, 0.8582677165354331, 0.8503937007874016, 0.84251968503937, 0.8346456692913385, 0.8267716535433071, 0.8188976377952756, 0.8110236220472441, 0.8031496062992126, 0.7952755905511811, 0.7874015748031497, 0.7795275590551181, 0.7716535433070866, 0.7637795275590551, 0.7559055118110236, 0.7480314960629921, 0.7401574803149606, 0.7322834645669292, 0.7244094488188977, 0.7165354330708661, 0.7086614173228346, 0.7007874015748031, 0.6929133858267716, 0.6850393700787402, 0.6771653543307087, 0.6692913385826772, 0.6614173228346457, 0.6535433070866141, 0.6456692913385826, 0.6377952755905512, 0.6299212598425197, 0.6220472440944882, 0.6141732283464567, 0.6062992125984252, 0.5984251968503937, 0.5905511811023622, 0.5826771653543307, 0.5748031496062992, 0.5669291338582677, 0.5590551181102362, 0.5511811023622047, 0.5433070866141733, 0.5354330708661418, 0.5275590551181102, 0.5196850393700787, 0.5118110236220472, 0.5039370078740157, 0.49606299212598426, 0.4881889763779528, 0.48031496062992124, 0.47244094488188976, 0.4645669291338583, 0.4566929133858268, 0.44881889763779526, 0.4409448818897638, 0.4330708661417323, 0.4251968503937008, 0.41732283464566927, 0.4094488188976378, 0.4015748031496063, 0.3937007874015748, 0.3858267716535433, 0.3779527559055118, 0.3700787401574803, 0.36220472440944884, 0.3543307086614173, 0.3464566929133858, 0.33858267716535434, 0.33070866141732286, 0.3228346456692913, 0.31496062992125984, 0.30708661417322836, 0.2992125984251969, 0.29133858267716534, 0.28346456692913385, 0.2755905511811024, 0.2677165354330709, 0.25984251968503935, 0.25196850393700787, 0.2440944881889764, 0.23622047244094488, 0.2283464566929134, 0.2204724409448819, 0.2125984251968504, 0.2047244094488189, 0.1968503937007874, 0.1889763779527559, 0.18110236220472442, 0.1732283464566929, 0.16535433070866143, 0.15748031496062992, 0.14960629921259844, 0.14173228346456693, 0.13385826771653545, 0.12598425196850394, 0.11811023622047244, 0.11023622047244094, 0.10236220472440945, 0.09448818897637795, 0.08661417322834646, 0.07874015748031496, 0.07086614173228346, 0.06299212598425197, 0.05511811023622047, 0.047244094488188976, 0.03937007874015748, 0.031496062992125984, 0.023622047244094488, 0.015748031496062992, 0.007874015748031496, 0],
      [0, 0.007874015748031496, 0.015748031496062992, 0.023622047244094488, 0.031496062992125984, 0.03937007874015748, 0.047244094488188976, 0.05511811023622047, 0.06299212598425197, 0.07086614173228346, 0.07874015748031496, 0.08661417322834646, 0.09448818897637795, 0.10236220472440945, 0.11023622047244094, 0.11811023622047244, 0.12598425196850394, 0.13385826771653545, 0.14173228346456693, 0.14960629921259844, 0.15748031496062992, 0.16535433070866143, 0.1732283464566929, 0.18110236220472442, 0.1889763779527559, 0.1968503937007874, 0.2047244094488189, 0.2125984251968504, 0.2204724409448819, 0.2283464566929134, 0.23622047244094488, 0.2440944881889764, 0.25196850393700787, 0.25984251968503935, 0.2677165354330709, 0.2755905511811024, 0.28346456692913385, 0.29133858267716534, 0.2992125984251969, 0.30708661417322836, 0.31496062992125984, 0.3228346456692913, 0.33070866141732286, 0.33858267716535434, 0.3464566929133858, 0.3543307086614173, 0.36220472440944884, 0.3700787401574803, 0.3779527559055118, 0.3858267716535433, 0.3937007874015748, 0.4015748031496063, 0.4094488188976378, 0.41732283464566927, 0.4251968503937008, 0.4330708661417323, 0.4409448818897638, 0.44881889763779526, 0.4566929133858268, 0.4645669291338583, 0.47244094488188976, 0.48031496062992124, 0.4881889763779528, 0.49606299212598426, 0.5039370078740157, 0.5118110236220472, 0.5196850393700787, 0.5275590551181102, 0.5354330708661418, 0.5433070866141733, 0.5511811023622047, 0.5590551181102362, 0.5669291338582677, 0.5748031496062992, 0.5826771653543307, 0.5905511811023622, 0.5984251968503937, 0.6062992125984252, 0.6141732283464567, 0.6220472440944882, 0.6299212598425197, 0.6377952755905512, 0.6456692913385826, 0.6535433070866141, 0.6614173228346457, 0.6692913385826772, 0.6771653543307087, 0.6850393700787402, 0.6929133858267716, 0.7007874015748031, 0.7086614173228346, 0.7165354330708661, 0.7244094488188977, 0.7322834645669292, 0.7401574803149606, 0.7480314960629921, 0.7559055118110236, 0.7637795275590551, 0.7716535433070866, 0.7795275590551181, 0.7874015748031497, 0.7952755905511811, 0.8031496062992126, 0.8110236220472441, 0.8188976377952756, 0.8267716535433071, 0.8346456692913385, 0.84251968503937, 0.8503937007874016, 0.8582677165354331, 0.8661417322834646, 0.8740157480314961, 0.8818897637795275, 0.889763779527559, 0.8976377952755905, 0.905511811023622, 0.9133858267716536, 0.9212598425196851, 0.9291338582677166, 0.937007874015748, 0.9448818897637795, 0.952755905511811, 0.9606299212598425, 0.968503937007874, 0.9763779527559056, 0.984251968503937, 0.9921259842519685, 1, 1, 0.9921259842519685, 0.984251968503937, 0.9763779527559056, 0.968503937007874, 0.9606299212598425, 0.952755905511811, 0.9448818897637795, 0.937007874015748, 0.9291338582677166, 0.9212598425196851, 0.9133858267716536, 0.905511811023622, 0.8976377952755905, 0.889763779527559, 0.8818897637795275, 0.8740157480314961, 0.8661417322834646, 0.8582677165354331, 0.8503937007874016, 0.84251968503937, 0.8346456692913385, 0.8267716535433071, 0.8188976377952756, 0.8110236220472441, 0.8031496062992126, 0.7952755905511811, 0.7874015748031497, 0.7795275590551181, 0.7716535433070866, 0.7637795275590551, 0.7559055118110236, 0.7480314960629921, 0.7401574803149606, 0.7322834645669292, 0.7244094488188977, 0.7165354330708661, 0.7086614173228346, 0.7007874015748031, 0.6929133858267716, 0.6850393700787402, 0.6771653543307087, 0.6692913385826772, 0.6614173228346457, 0.6535433070866141, 0.6456692913385826, 0.6377952755905512, 0.6299212598425197, 0.6220472440944882, 0.6141732283464567, 0.6062992125984252, 0.5984251968503937, 0.5905511811023622, 0.5826771653543307, 0.5748031496062992, 0.5669291338582677, 0.5590551181102362, 0.5511811023622047, 0.5433070866141733, 0.5354330708661418, 0.5275590551181102, 0.5196850393700787, 0.5118110236220472, 0.5039370078740157, 0.49606299212598426, 0.4881889763779528, 0.48031496062992124, 0.47244094488188976, 0.4645669291338583, 0.4566929133858268, 0.44881889763779526, 0.4409448818897638, 0.4330708661417323, 0.4251968503937008, 0.41732283464566927, 0.4094488188976378, 0.4015748031496063, 0.3937007874015748, 0.3858267716535433, 0.3779527559055118, 0.3700787401574803, 0.36220472440944884, 0.3543307086614173, 0.3464566929133858, 0.33858267716535434, 0.33070866141732286, 0.3228346456692913, 0.31496062992125984, 0.30708661417322836, 0.2992125984251969, 0.29133858267716534, 0.28346456692913385, 0.2755905511811024, 0.2677165354330709, 0.25984251968503935, 0.25196850393700787, 0.2440944881889764, 0.23622047244094488, 0.2283464566929134, 0.2204724409448819, 0.2125984251968504, 0.2047244094488189, 0.1968503937007874, 0.1889763779527559, 0.18110236220472442, 0.1732283464566929, 0.16535433070866143, 0.15748031496062992, 0.14960629921259844, 0.14173228346456693, 0.13385826771653545, 0.12598425196850394, 0.11811023622047244, 0.11023622047244094, 0.10236220472440945, 0.09448818897637795, 0.08661417322834646, 0.07874015748031496, 0.07086614173228346, 0.06299212598425197, 0.05511811023622047, 0.047244094488188976, 0.03937007874015748, 0.031496062992125984, 0.023622047244094488, 0.015748031496062992, 0.007874015748031496, 0]
    ],
    // Spherical
    [
      // Mid
      [0.00015059065189787502, 0.0006022718974137975, 0.0013547716606548965, 0.0024076366639015356, 0.0037602327006450165, 0.005411745017609493, 0.007361178805529389, 0.009607359798384785, 0.012148934980735715, 0.014984373402728013, 0.01811196710228008, 0.021529832133895588, 0.025235909703481663, 0.029227967408489597, 0.03350360058263058, 0.03806023374435663, 0.042895122148234655, 0.04800535343827833, 0.05338784940224234, 0.059039367825822475, 0.06495650444564427, 0.071135694999864, 0.07757321737514644, 0.08426519384872738, 0.09120759342420814, 0.09839623425967753, 0.10582678618669683, 0.1134947733186315, 0.12139557674675772, 0.12952443732252045, 0.1378764585242665, 0.1464466094067262, 0.15522972763146653, 0.16422052257649078, 0.17341357852311157, 0.18280335791817726, 0.1923842047096866, 0.20215034775378332, 0.21209590429107733, 0.22221488349019886, 0.23250119005645137, 0.24294862790338917, 0.2535509038851079, 0.2643016315870012, 0.2751943351726967, 0.2862224532848589, 0.29737934299750507, 0.3086582838174551, 0.3200524817325059, 0.33155507330389, 0.3431591298005542, 0.35485766137276886, 0.3666436212625508, 0.378509910048368, 0.39044937992156514, 0.40245483899193585, 0.4145190556198494, 0.42663476277231915, 0.4387946624003919, 0.4509914298352197, 0.4632177182001663, 0.47546616283629095, 0.48772938573854385, 0.49999999999999994, 0.5122706142614561, 0.524533837163709, 0.5367822817998337, 0.5490085701647803, 0.5612053375996081, 0.5733652372276808, 0.5854809443801506, 0.5975451610080641, 0.609550620078435, 0.6214900899516319, 0.6333563787374492, 0.6451423386272312, 0.6568408701994457, 0.66844492669611, 0.6799475182674941, 0.6913417161825448, 0.702620657002495, 0.7137775467151409, 0.7248056648273034, 0.7356983684129988, 0.746449096114892, 0.7570513720966108, 0.7674988099435485, 0.7777851165098011, 0.7879040957089227, 0.7978496522462166, 0.8076157952903134, 0.8171966420818226, 0.8265864214768884, 0.8357794774235092, 0.8447702723685335, 0.8535533905932737, 0.8621235414757333, 0.8704755626774794, 0.8786044232532424, 0.8865052266813684, 0.8941732138133032, 0.9016037657403224, 0.9087924065757917, 0.9157348061512727, 0.9224267826248536, 0.928864305000136, 0.9350434955543556, 0.9409606321741775, 0.9466121505977577, 0.9519946465617217, 0.9571048778517653, 0.9619397662556434, 0.9664963994173694, 0.9707720325915103, 0.9747640902965183, 0.9784701678661044, 0.98188803289772, 0.985015626597272, 0.9878510650192642, 0.9903926402016152, 0.9926388211944706, 0.9945882549823906, 0.996239767299355, 0.9975923633360984, 0.9986452283393451, 0.9993977281025862, 0.9998494093481021, 1, 1, 0.9998494093481021, 0.9993977281025862, 0.9986452283393451, 0.9975923633360984, 0.996239767299355, 0.9945882549823906, 0.9926388211944706, 0.9903926402016152, 0.9878510650192642, 0.985015626597272, 0.98188803289772, 0.9784701678661044, 0.9747640902965183, 0.9707720325915103, 0.9664963994173694, 0.9619397662556434, 0.9571048778517653, 0.9519946465617217, 0.9466121505977577, 0.9409606321741775, 0.9350434955543556, 0.928864305000136, 0.9224267826248536, 0.9157348061512727, 0.9087924065757917, 0.9016037657403224, 0.8941732138133032, 0.8865052266813684, 0.8786044232532424, 0.8704755626774794, 0.8621235414757333, 0.8535533905932737, 0.8447702723685335, 0.8357794774235092, 0.8265864214768884, 0.8171966420818226, 0.8076157952903134, 0.7978496522462166, 0.7879040957089227, 0.7777851165098011, 0.7674988099435485, 0.7570513720966108, 0.746449096114892, 0.7356983684129988, 0.7248056648273034, 0.7137775467151409, 0.702620657002495, 0.6913417161825448, 0.6799475182674941, 0.66844492669611, 0.6568408701994457, 0.6451423386272312, 0.6333563787374492, 0.6214900899516319, 0.609550620078435, 0.5975451610080641, 0.5854809443801506, 0.5733652372276808, 0.5612053375996081, 0.5490085701647803, 0.5367822817998337, 0.524533837163709, 0.5122706142614561, 0.49999999999999994, 0.48772938573854385, 0.47546616283629095, 0.4632177182001663, 0.4509914298352197, 0.4387946624003919, 0.42663476277231915, 0.4145190556198494, 0.40245483899193585, 0.39044937992156514, 0.378509910048368, 0.3666436212625508, 0.35485766137276886, 0.3431591298005542, 0.33155507330389, 0.3200524817325059, 0.3086582838174551, 0.29737934299750507, 0.2862224532848589, 0.2751943351726967, 0.2643016315870012, 0.2535509038851079, 0.24294862790338917, 0.23250119005645137, 0.22221488349019886, 0.21209590429107733, 0.20215034775378332, 0.1923842047096866, 0.18280335791817726, 0.17341357852311157, 0.16422052257649078, 0.15522972763146653, 0.1464466094067262, 0.1378764585242665, 0.12952443732252045, 0.12139557674675772, 0.1134947733186315, 0.10582678618669683, 0.09839623425967753, 0.09120759342420814, 0.08426519384872738, 0.07757321737514644, 0.071135694999864, 0.06495650444564427, 0.059039367825822475, 0.05338784940224234, 0.04800535343827833, 0.042895122148234655, 0.03806023374435663, 0.03350360058263058, 0.029227967408489597, 0.025235909703481663, 0.021529832133895588, 0.01811196710228008, 0.014984373402728013, 0.012148934980735715, 0.009607359798384785, 0.007361178805529389, 0.005411745017609493, 0.0037602327006450165, 0.0024076366639015356, 0.0013547716606548965, 0.0006022718974137975, 0.00015059065189787502],
      [0.00015059065189787502, 0.0006022718974137975, 0.0013547716606548965, 0.0024076366639015356, 0.0037602327006450165, 0.005411745017609493, 0.007361178805529389, 0.009607359798384785, 0.012148934980735715, 0.014984373402728013, 0.01811196710228008, 0.021529832133895588, 0.025235909703481663, 0.029227967408489597, 0.03350360058263058, 0.03806023374435663, 0.042895122148234655, 0.04800535343827833, 0.05338784940224234, 0.059039367825822475, 0.06495650444564427, 0.071135694999864, 0.07757321737514644, 0.08426519384872738, 0.09120759342420814, 0.09839623425967753, 0.10582678618669683, 0.1134947733186315, 0.12139557674675772, 0.12952443732252045, 0.1378764585242665, 0.1464466094067262, 0.15522972763146653, 0.16422052257649078, 0.17341357852311157, 0.18280335791817726, 0.1923842047096866, 0.20215034775378332, 0.21209590429107733, 0.22221488349019886, 0.23250119005645137, 0.24294862790338917, 0.2535509038851079, 0.2643016315870012, 0.2751943351726967, 0.2862224532848589, 0.29737934299750507, 0.3086582838174551, 0.3200524817325059, 0.33155507330389, 0.3431591298005542, 0.35485766137276886, 0.3666436212625508, 0.378509910048368, 0.39044937992156514, 0.40245483899193585, 0.4145190556198494, 0.42663476277231915, 0.4387946624003919, 0.4509914298352197, 0.4632177182001663, 0.47546616283629095, 0.48772938573854385, 0.49999999999999994, 0.5122706142614561, 0.524533837163709, 0.5367822817998337, 0.5490085701647803, 0.5612053375996081, 0.5733652372276808, 0.5854809443801506, 0.5975451610080641, 0.609550620078435, 0.6214900899516319, 0.6333563787374492, 0.6451423386272312, 0.6568408701994457, 0.66844492669611, 0.6799475182674941, 0.6913417161825448, 0.702620657002495, 0.7137775467151409, 0.7248056648273034, 0.7356983684129988, 0.746449096114892, 0.7570513720966108, 0.7674988099435485, 0.7777851165098011, 0.7879040957089227, 0.7978496522462166, 0.8076157952903134, 0.8171966420818226, 0.8265864214768884, 0.8357794774235092, 0.8447702723685335, 0.8535533905932737, 0.8621235414757333, 0.8704755626774794, 0.8786044232532424, 0.8865052266813684, 0.8941732138133032, 0.9016037657403224, 0.9087924065757917, 0.9157348061512727, 0.9224267826248536, 0.928864305000136, 0.9350434955543556, 0.9409606321741775, 0.9466121505977577, 0.9519946465617217, 0.9571048778517653, 0.9619397662556434, 0.9664963994173694, 0.9707720325915103, 0.9747640902965183, 0.9784701678661044, 0.98188803289772, 0.985015626597272, 0.9878510650192642, 0.9903926402016152, 0.9926388211944706, 0.9945882549823906, 0.996239767299355, 0.9975923633360984, 0.9986452283393451, 0.9993977281025862, 0.9998494093481021, 1, 1, 0.9998494093481021, 0.9993977281025862, 0.9986452283393451, 0.9975923633360984, 0.996239767299355, 0.9945882549823906, 0.9926388211944706, 0.9903926402016152, 0.9878510650192642, 0.985015626597272, 0.98188803289772, 0.9784701678661044, 0.9747640902965183, 0.9707720325915103, 0.9664963994173694, 0.9619397662556434, 0.9571048778517653, 0.9519946465617217, 0.9466121505977577, 0.9409606321741775, 0.9350434955543556, 0.928864305000136, 0.9224267826248536, 0.9157348061512727, 0.9087924065757917, 0.9016037657403224, 0.8941732138133032, 0.8865052266813684, 0.8786044232532424, 0.8704755626774794, 0.8621235414757333, 0.8535533905932737, 0.8447702723685335, 0.8357794774235092, 0.8265864214768884, 0.8171966420818226, 0.8076157952903134, 0.7978496522462166, 0.7879040957089227, 0.7777851165098011, 0.7674988099435485, 0.7570513720966108, 0.746449096114892, 0.7356983684129988, 0.7248056648273034, 0.7137775467151409, 0.702620657002495, 0.6913417161825448, 0.6799475182674941, 0.66844492669611, 0.6568408701994457, 0.6451423386272312, 0.6333563787374492, 0.6214900899516319, 0.609550620078435, 0.5975451610080641, 0.5854809443801506, 0.5733652372276808, 0.5612053375996081, 0.5490085701647803, 0.5367822817998337, 0.524533837163709, 0.5122706142614561, 0.49999999999999994, 0.48772938573854385, 0.47546616283629095, 0.4632177182001663, 0.4509914298352197, 0.4387946624003919, 0.42663476277231915, 0.4145190556198494, 0.40245483899193585, 0.39044937992156514, 0.378509910048368, 0.3666436212625508, 0.35485766137276886, 0.3431591298005542, 0.33155507330389, 0.3200524817325059, 0.3086582838174551, 0.29737934299750507, 0.2862224532848589, 0.2751943351726967, 0.2643016315870012, 0.2535509038851079, 0.24294862790338917, 0.23250119005645137, 0.22221488349019886, 0.21209590429107733, 0.20215034775378332, 0.1923842047096866, 0.18280335791817726, 0.17341357852311157, 0.16422052257649078, 0.15522972763146653, 0.1464466094067262, 0.1378764585242665, 0.12952443732252045, 0.12139557674675772, 0.1134947733186315, 0.10582678618669683, 0.09839623425967753, 0.09120759342420814, 0.08426519384872738, 0.07757321737514644, 0.071135694999864, 0.06495650444564427, 0.059039367825822475, 0.05338784940224234, 0.04800535343827833, 0.042895122148234655, 0.03806023374435663, 0.03350360058263058, 0.029227967408489597, 0.025235909703481663, 0.021529832133895588, 0.01811196710228008, 0.014984373402728013, 0.012148934980735715, 0.009607359798384785, 0.007361178805529389, 0.005411745017609493, 0.0037602327006450165, 0.0024076366639015356, 0.0013547716606548965, 0.0006022718974137975, 0.00015059065189787502],
      [0.00015059065189787502, 0.0006022718974137975, 0.0013547716606548965, 0.0024076366639015356, 0.0037602327006450165, 0.005411745017609493, 0.007361178805529389, 0.009607359798384785, 0.012148934980735715, 0.014984373402728013, 0.01811196710228008, 0.021529832133895588, 0.025235909703481663, 0.029227967408489597, 0.03350360058263058, 0.03806023374435663, 0.042895122148234655, 0.04800535343827833, 0.05338784940224234, 0.059039367825822475, 0.06495650444564427, 0.071135694999864, 0.07757321737514644, 0.08426519384872738, 0.09120759342420814, 0.09839623425967753, 0.10582678618669683, 0.1134947733186315, 0.12139557674675772, 0.12952443732252045, 0.1378764585242665, 0.1464466094067262, 0.15522972763146653, 0.16422052257649078, 0.17341357852311157, 0.18280335791817726, 0.1923842047096866, 0.20215034775378332, 0.21209590429107733, 0.22221488349019886, 0.23250119005645137, 0.24294862790338917, 0.2535509038851079, 0.2643016315870012, 0.2751943351726967, 0.2862224532848589, 0.29737934299750507, 0.3086582838174551, 0.3200524817325059, 0.33155507330389, 0.3431591298005542, 0.35485766137276886, 0.3666436212625508, 0.378509910048368, 0.39044937992156514, 0.40245483899193585, 0.4145190556198494, 0.42663476277231915, 0.4387946624003919, 0.4509914298352197, 0.4632177182001663, 0.47546616283629095, 0.48772938573854385, 0.49999999999999994, 0.5122706142614561, 0.524533837163709, 0.5367822817998337, 0.5490085701647803, 0.5612053375996081, 0.5733652372276808, 0.5854809443801506, 0.5975451610080641, 0.609550620078435, 0.6214900899516319, 0.6333563787374492, 0.6451423386272312, 0.6568408701994457, 0.66844492669611, 0.6799475182674941, 0.6913417161825448, 0.702620657002495, 0.7137775467151409, 0.7248056648273034, 0.7356983684129988, 0.746449096114892, 0.7570513720966108, 0.7674988099435485, 0.7777851165098011, 0.7879040957089227, 0.7978496522462166, 0.8076157952903134, 0.8171966420818226, 0.8265864214768884, 0.8357794774235092, 0.8447702723685335, 0.8535533905932737, 0.8621235414757333, 0.8704755626774794, 0.8786044232532424, 0.8865052266813684, 0.8941732138133032, 0.9016037657403224, 0.9087924065757917, 0.9157348061512727, 0.9224267826248536, 0.928864305000136, 0.9350434955543556, 0.9409606321741775, 0.9466121505977577, 0.9519946465617217, 0.9571048778517653, 0.9619397662556434, 0.9664963994173694, 0.9707720325915103, 0.9747640902965183, 0.9784701678661044, 0.98188803289772, 0.985015626597272, 0.9878510650192642, 0.9903926402016152, 0.9926388211944706, 0.9945882549823906, 0.996239767299355, 0.9975923633360984, 0.9986452283393451, 0.9993977281025862, 0.9998494093481021, 1, 1, 0.9998494093481021, 0.9993977281025862, 0.9986452283393451, 0.9975923633360984, 0.996239767299355, 0.9945882549823906, 0.9926388211944706, 0.9903926402016152, 0.9878510650192642, 0.985015626597272, 0.98188803289772, 0.9784701678661044, 0.9747640902965183, 0.9707720325915103, 0.9664963994173694, 0.9619397662556434, 0.9571048778517653, 0.9519946465617217, 0.9466121505977577, 0.9409606321741775, 0.9350434955543556, 0.928864305000136, 0.9224267826248536, 0.9157348061512727, 0.9087924065757917, 0.9016037657403224, 0.8941732138133032, 0.8865052266813684, 0.8786044232532424, 0.8704755626774794, 0.8621235414757333, 0.8535533905932737, 0.8447702723685335, 0.8357794774235092, 0.8265864214768884, 0.8171966420818226, 0.8076157952903134, 0.7978496522462166, 0.7879040957089227, 0.7777851165098011, 0.7674988099435485, 0.7570513720966108, 0.746449096114892, 0.7356983684129988, 0.7248056648273034, 0.7137775467151409, 0.702620657002495, 0.6913417161825448, 0.6799475182674941, 0.66844492669611, 0.6568408701994457, 0.6451423386272312, 0.6333563787374492, 0.6214900899516319, 0.609550620078435, 0.5975451610080641, 0.5854809443801506, 0.5733652372276808, 0.5612053375996081, 0.5490085701647803, 0.5367822817998337, 0.524533837163709, 0.5122706142614561, 0.49999999999999994, 0.48772938573854385, 0.47546616283629095, 0.4632177182001663, 0.4509914298352197, 0.4387946624003919, 0.42663476277231915, 0.4145190556198494, 0.40245483899193585, 0.39044937992156514, 0.378509910048368, 0.3666436212625508, 0.35485766137276886, 0.3431591298005542, 0.33155507330389, 0.3200524817325059, 0.3086582838174551, 0.29737934299750507, 0.2862224532848589, 0.2751943351726967, 0.2643016315870012, 0.2535509038851079, 0.24294862790338917, 0.23250119005645137, 0.22221488349019886, 0.21209590429107733, 0.20215034775378332, 0.1923842047096866, 0.18280335791817726, 0.17341357852311157, 0.16422052257649078, 0.15522972763146653, 0.1464466094067262, 0.1378764585242665, 0.12952443732252045, 0.12139557674675772, 0.1134947733186315, 0.10582678618669683, 0.09839623425967753, 0.09120759342420814, 0.08426519384872738, 0.07757321737514644, 0.071135694999864, 0.06495650444564427, 0.059039367825822475, 0.05338784940224234, 0.04800535343827833, 0.042895122148234655, 0.03806023374435663, 0.03350360058263058, 0.029227967408489597, 0.025235909703481663, 0.021529832133895588, 0.01811196710228008, 0.014984373402728013, 0.012148934980735715, 0.009607359798384785, 0.007361178805529389, 0.005411745017609493, 0.0037602327006450165, 0.0024076366639015356, 0.0013547716606548965, 0.0006022718974137975, 0.00015059065189787502],
      [0.00015059065189787502, 0.0006022718974137975, 0.0013547716606548965, 0.0024076366639015356, 0.0037602327006450165, 0.005411745017609493, 0.007361178805529389, 0.009607359798384785, 0.012148934980735715, 0.014984373402728013, 0.01811196710228008, 0.021529832133895588, 0.025235909703481663, 0.029227967408489597, 0.03350360058263058, 0.03806023374435663, 0.042895122148234655, 0.04800535343827833, 0.05338784940224234, 0.059039367825822475, 0.06495650444564427, 0.071135694999864, 0.07757321737514644, 0.08426519384872738, 0.09120759342420814, 0.09839623425967753, 0.10582678618669683, 0.1134947733186315, 0.12139557674675772, 0.12952443732252045, 0.1378764585242665, 0.1464466094067262, 0.15522972763146653, 0.16422052257649078, 0.17341357852311157, 0.18280335791817726, 0.1923842047096866, 0.20215034775378332, 0.21209590429107733, 0.22221488349019886, 0.23250119005645137, 0.24294862790338917, 0.2535509038851079, 0.2643016315870012, 0.2751943351726967, 0.2862224532848589, 0.29737934299750507, 0.3086582838174551, 0.3200524817325059, 0.33155507330389, 0.3431591298005542, 0.35485766137276886, 0.3666436212625508, 0.378509910048368, 0.39044937992156514, 0.40245483899193585, 0.4145190556198494, 0.42663476277231915, 0.4387946624003919, 0.4509914298352197, 0.4632177182001663, 0.47546616283629095, 0.48772938573854385, 0.49999999999999994, 0.5122706142614561, 0.524533837163709, 0.5367822817998337, 0.5490085701647803, 0.5612053375996081, 0.5733652372276808, 0.5854809443801506, 0.5975451610080641, 0.609550620078435, 0.6214900899516319, 0.6333563787374492, 0.6451423386272312, 0.6568408701994457, 0.66844492669611, 0.6799475182674941, 0.6913417161825448, 0.702620657002495, 0.7137775467151409, 0.7248056648273034, 0.7356983684129988, 0.746449096114892, 0.7570513720966108, 0.7674988099435485, 0.7777851165098011, 0.7879040957089227, 0.7978496522462166, 0.8076157952903134, 0.8171966420818226, 0.8265864214768884, 0.8357794774235092, 0.8447702723685335, 0.8535533905932737, 0.8621235414757333, 0.8704755626774794, 0.8786044232532424, 0.8865052266813684, 0.8941732138133032, 0.9016037657403224, 0.9087924065757917, 0.9157348061512727, 0.9224267826248536, 0.928864305000136, 0.9350434955543556, 0.9409606321741775, 0.9466121505977577, 0.9519946465617217, 0.9571048778517653, 0.9619397662556434, 0.9664963994173694, 0.9707720325915103, 0.9747640902965183, 0.9784701678661044, 0.98188803289772, 0.985015626597272, 0.9878510650192642, 0.9903926402016152, 0.9926388211944706, 0.9945882549823906, 0.996239767299355, 0.9975923633360984, 0.9986452283393451, 0.9993977281025862, 0.9998494093481021, 1, 1, 0.9998494093481021, 0.9993977281025862, 0.9986452283393451, 0.9975923633360984, 0.996239767299355, 0.9945882549823906, 0.9926388211944706, 0.9903926402016152, 0.9878510650192642, 0.985015626597272, 0.98188803289772, 0.9784701678661044, 0.9747640902965183, 0.9707720325915103, 0.9664963994173694, 0.9619397662556434, 0.9571048778517653, 0.9519946465617217, 0.9466121505977577, 0.9409606321741775, 0.9350434955543556, 0.928864305000136, 0.9224267826248536, 0.9157348061512727, 0.9087924065757917, 0.9016037657403224, 0.8941732138133032, 0.8865052266813684, 0.8786044232532424, 0.8704755626774794, 0.8621235414757333, 0.8535533905932737, 0.8447702723685335, 0.8357794774235092, 0.8265864214768884, 0.8171966420818226, 0.8076157952903134, 0.7978496522462166, 0.7879040957089227, 0.7777851165098011, 0.7674988099435485, 0.7570513720966108, 0.746449096114892, 0.7356983684129988, 0.7248056648273034, 0.7137775467151409, 0.702620657002495, 0.6913417161825448, 0.6799475182674941, 0.66844492669611, 0.6568408701994457, 0.6451423386272312, 0.6333563787374492, 0.6214900899516319, 0.609550620078435, 0.5975451610080641, 0.5854809443801506, 0.5733652372276808, 0.5612053375996081, 0.5490085701647803, 0.5367822817998337, 0.524533837163709, 0.5122706142614561, 0.49999999999999994, 0.48772938573854385, 0.47546616283629095, 0.4632177182001663, 0.4509914298352197, 0.4387946624003919, 0.42663476277231915, 0.4145190556198494, 0.40245483899193585, 0.39044937992156514, 0.378509910048368, 0.3666436212625508, 0.35485766137276886, 0.3431591298005542, 0.33155507330389, 0.3200524817325059, 0.3086582838174551, 0.29737934299750507, 0.2862224532848589, 0.2751943351726967, 0.2643016315870012, 0.2535509038851079, 0.24294862790338917, 0.23250119005645137, 0.22221488349019886, 0.21209590429107733, 0.20215034775378332, 0.1923842047096866, 0.18280335791817726, 0.17341357852311157, 0.16422052257649078, 0.15522972763146653, 0.1464466094067262, 0.1378764585242665, 0.12952443732252045, 0.12139557674675772, 0.1134947733186315, 0.10582678618669683, 0.09839623425967753, 0.09120759342420814, 0.08426519384872738, 0.07757321737514644, 0.071135694999864, 0.06495650444564427, 0.059039367825822475, 0.05338784940224234, 0.04800535343827833, 0.042895122148234655, 0.03806023374435663, 0.03350360058263058, 0.029227967408489597, 0.025235909703481663, 0.021529832133895588, 0.01811196710228008, 0.014984373402728013, 0.012148934980735715, 0.009607359798384785, 0.007361178805529389, 0.005411745017609493, 0.0037602327006450165, 0.0024076366639015356, 0.0013547716606548965, 0.0006022718974137975, 0.00015059065189787502],
      [0.00015059065189787502, 0.0006022718974137975, 0.0013547716606548965, 0.0024076366639015356, 0.0037602327006450165, 0.005411745017609493, 0.007361178805529389, 0.009607359798384785, 0.012148934980735715, 0.014984373402728013, 0.01811196710228008, 0.021529832133895588, 0.025235909703481663, 0.029227967408489597, 0.03350360058263058, 0.03806023374435663, 0.042895122148234655, 0.04800535343827833, 0.05338784940224234, 0.059039367825822475, 0.06495650444564427, 0.071135694999864, 0.07757321737514644, 0.08426519384872738, 0.09120759342420814, 0.09839623425967753, 0.10582678618669683, 0.1134947733186315, 0.12139557674675772, 0.12952443732252045, 0.1378764585242665, 0.1464466094067262, 0.15522972763146653, 0.16422052257649078, 0.17341357852311157, 0.18280335791817726, 0.1923842047096866, 0.20215034775378332, 0.21209590429107733, 0.22221488349019886, 0.23250119005645137, 0.24294862790338917, 0.2535509038851079, 0.2643016315870012, 0.2751943351726967, 0.2862224532848589, 0.29737934299750507, 0.3086582838174551, 0.3200524817325059, 0.33155507330389, 0.3431591298005542, 0.35485766137276886, 0.3666436212625508, 0.378509910048368, 0.39044937992156514, 0.40245483899193585, 0.4145190556198494, 0.42663476277231915, 0.4387946624003919, 0.4509914298352197, 0.4632177182001663, 0.47546616283629095, 0.48772938573854385, 0.49999999999999994, 0.5122706142614561, 0.524533837163709, 0.5367822817998337, 0.5490085701647803, 0.5612053375996081, 0.5733652372276808, 0.5854809443801506, 0.5975451610080641, 0.609550620078435, 0.6214900899516319, 0.6333563787374492, 0.6451423386272312, 0.6568408701994457, 0.66844492669611, 0.6799475182674941, 0.6913417161825448, 0.702620657002495, 0.7137775467151409, 0.7248056648273034, 0.7356983684129988, 0.746449096114892, 0.7570513720966108, 0.7674988099435485, 0.7777851165098011, 0.7879040957089227, 0.7978496522462166, 0.8076157952903134, 0.8171966420818226, 0.8265864214768884, 0.8357794774235092, 0.8447702723685335, 0.8535533905932737, 0.8621235414757333, 0.8704755626774794, 0.8786044232532424, 0.8865052266813684, 0.8941732138133032, 0.9016037657403224, 0.9087924065757917, 0.9157348061512727, 0.9224267826248536, 0.928864305000136, 0.9350434955543556, 0.9409606321741775, 0.9466121505977577, 0.9519946465617217, 0.9571048778517653, 0.9619397662556434, 0.9664963994173694, 0.9707720325915103, 0.9747640902965183, 0.9784701678661044, 0.98188803289772, 0.985015626597272, 0.9878510650192642, 0.9903926402016152, 0.9926388211944706, 0.9945882549823906, 0.996239767299355, 0.9975923633360984, 0.9986452283393451, 0.9993977281025862, 0.9998494093481021, 1, 1, 0.9998494093481021, 0.9993977281025862, 0.9986452283393451, 0.9975923633360984, 0.996239767299355, 0.9945882549823906, 0.9926388211944706, 0.9903926402016152, 0.9878510650192642, 0.985015626597272, 0.98188803289772, 0.9784701678661044, 0.9747640902965183, 0.9707720325915103, 0.9664963994173694, 0.9619397662556434, 0.9571048778517653, 0.9519946465617217, 0.9466121505977577, 0.9409606321741775, 0.9350434955543556, 0.928864305000136, 0.9224267826248536, 0.9157348061512727, 0.9087924065757917, 0.9016037657403224, 0.8941732138133032, 0.8865052266813684, 0.8786044232532424, 0.8704755626774794, 0.8621235414757333, 0.8535533905932737, 0.8447702723685335, 0.8357794774235092, 0.8265864214768884, 0.8171966420818226, 0.8076157952903134, 0.7978496522462166, 0.7879040957089227, 0.7777851165098011, 0.7674988099435485, 0.7570513720966108, 0.746449096114892, 0.7356983684129988, 0.7248056648273034, 0.7137775467151409, 0.702620657002495, 0.6913417161825448, 0.6799475182674941, 0.66844492669611, 0.6568408701994457, 0.6451423386272312, 0.6333563787374492, 0.6214900899516319, 0.609550620078435, 0.5975451610080641, 0.5854809443801506, 0.5733652372276808, 0.5612053375996081, 0.5490085701647803, 0.5367822817998337, 0.524533837163709, 0.5122706142614561, 0.49999999999999994, 0.48772938573854385, 0.47546616283629095, 0.4632177182001663, 0.4509914298352197, 0.4387946624003919, 0.42663476277231915, 0.4145190556198494, 0.40245483899193585, 0.39044937992156514, 0.378509910048368, 0.3666436212625508, 0.35485766137276886, 0.3431591298005542, 0.33155507330389, 0.3200524817325059, 0.3086582838174551, 0.29737934299750507, 0.2862224532848589, 0.2751943351726967, 0.2643016315870012, 0.2535509038851079, 0.24294862790338917, 0.23250119005645137, 0.22221488349019886, 0.21209590429107733, 0.20215034775378332, 0.1923842047096866, 0.18280335791817726, 0.17341357852311157, 0.16422052257649078, 0.15522972763146653, 0.1464466094067262, 0.1378764585242665, 0.12952443732252045, 0.12139557674675772, 0.1134947733186315, 0.10582678618669683, 0.09839623425967753, 0.09120759342420814, 0.08426519384872738, 0.07757321737514644, 0.071135694999864, 0.06495650444564427, 0.059039367825822475, 0.05338784940224234, 0.04800535343827833, 0.042895122148234655, 0.03806023374435663, 0.03350360058263058, 0.029227967408489597, 0.025235909703481663, 0.021529832133895588, 0.01811196710228008, 0.014984373402728013, 0.012148934980735715, 0.009607359798384785, 0.007361178805529389, 0.005411745017609493, 0.0037602327006450165, 0.0024076366639015356, 0.0013547716606548965, 0.0006022718974137975, 0.00015059065189787502]
    ],
    // Full
    [
      [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
      [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
      [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
      [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
      [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
    ]
  ],
  // [0, 0.007874015748031496, 0.015748031496062992, 0.023622047244094488, 0.031496062992125984, 0.03937007874015748, 0.047244094488188976, 0.05511811023622047, 0.06299212598425197, 0.07086614173228346, 0.07874015748031496, 0.08661417322834646, 0.09448818897637795, 0.10236220472440945, 0.11023622047244094, 0.11811023622047244, 0.12598425196850394, 0.13385826771653545, 0.14173228346456693, 0.14960629921259844, 0.15748031496062992, 0.16535433070866143, 0.1732283464566929, 0.18110236220472442, 0.1889763779527559, 0.1968503937007874, 0.2047244094488189, 0.2125984251968504, 0.2204724409448819, 0.2283464566929134, 0.23622047244094488, 0.2440944881889764, 0.25196850393700787, 0.25984251968503935, 0.2677165354330709, 0.2755905511811024, 0.28346456692913385, 0.29133858267716534, 0.2992125984251969, 0.30708661417322836, 0.31496062992125984, 0.3228346456692913, 0.33070866141732286, 0.33858267716535434, 0.3464566929133858, 0.3543307086614173, 0.36220472440944884, 0.3700787401574803, 0.3779527559055118, 0.3858267716535433, 0.3937007874015748, 0.4015748031496063, 0.4094488188976378, 0.41732283464566927, 0.4251968503937008, 0.4330708661417323, 0.4409448818897638, 0.44881889763779526, 0.4566929133858268, 0.4645669291338583, 0.47244094488188976, 0.48031496062992124, 0.4881889763779528, 0.49606299212598426, 0.5039370078740157, 0.5118110236220472, 0.5196850393700787, 0.5275590551181102, 0.5354330708661418, 0.5433070866141733, 0.5511811023622047, 0.5590551181102362, 0.5669291338582677, 0.5748031496062992, 0.5826771653543307, 0.5905511811023622, 0.5984251968503937, 0.6062992125984252, 0.6141732283464567, 0.6220472440944882, 0.6299212598425197, 0.6377952755905512, 0.6456692913385826, 0.6535433070866141, 0.6614173228346457, 0.6692913385826772, 0.6771653543307087, 0.6850393700787402, 0.6929133858267716, 0.7007874015748031, 0.7086614173228346, 0.7165354330708661, 0.7244094488188977, 0.7322834645669292, 0.7401574803149606, 0.7480314960629921, 0.7559055118110236, 0.7637795275590551, 0.7716535433070866, 0.7795275590551181, 0.7874015748031497, 0.7952755905511811, 0.8031496062992126, 0.8110236220472441, 0.8188976377952756, 0.8267716535433071, 0.8346456692913385, 0.84251968503937, 0.8503937007874016, 0.8582677165354331, 0.8661417322834646, 0.8740157480314961, 0.8818897637795275, 0.889763779527559, 0.8976377952755905, 0.905511811023622, 0.9133858267716536, 0.9212598425196851, 0.9291338582677166, 0.937007874015748, 0.9448818897637795, 0.952755905511811, 0.9606299212598425, 0.968503937007874, 0.9763779527559056, 0.984251968503937, 0.9921259842519685, 1, -1, -0.9921259842519685, -0.984251968503937, -0.9763779527559056, -0.968503937007874, -0.9606299212598425, -0.952755905511811, -0.9448818897637795, -0.937007874015748, -0.9291338582677166, -0.9212598425196851, -0.9133858267716536, -0.905511811023622, -0.8976377952755905, -0.889763779527559, -0.8818897637795275, -0.8740157480314961, -0.8661417322834646, -0.8582677165354331, -0.8503937007874016, -0.84251968503937, -0.8346456692913385, -0.8267716535433071, -0.8188976377952756, -0.8110236220472441, -0.8031496062992126, -0.7952755905511811, -0.7874015748031497, -0.7795275590551181, -0.7716535433070866, -0.7637795275590551, -0.7559055118110236, -0.7480314960629921, -0.7401574803149606, -0.7322834645669292, -0.7244094488188977, -0.7165354330708661, -0.7086614173228346, -0.7007874015748031, -0.6929133858267716, -0.6850393700787402, -0.6771653543307087, -0.6692913385826772, -0.6614173228346457, -0.6535433070866141, -0.6456692913385826, -0.6377952755905512, -0.6299212598425197, -0.6220472440944882, -0.6141732283464567, -0.6062992125984252, -0.5984251968503937, -0.5905511811023622, -0.5826771653543307, -0.5748031496062992, -0.5669291338582677, -0.5590551181102362, -0.5511811023622047, -0.5433070866141733, -0.5354330708661418, -0.5275590551181102, -0.5196850393700787, -0.5118110236220472, -0.5039370078740157, -0.49606299212598426, -0.4881889763779528, -0.48031496062992124, -0.47244094488188976, -0.4645669291338583, -0.4566929133858268, -0.44881889763779526, -0.4409448818897638, -0.4330708661417323, -0.4251968503937008, -0.41732283464566927, -0.4094488188976378, -0.4015748031496063, -0.3937007874015748, -0.3858267716535433, -0.3779527559055118, -0.3700787401574803, -0.36220472440944884, -0.3543307086614173, -0.3464566929133858, -0.33858267716535434, -0.33070866141732286, -0.3228346456692913, -0.31496062992125984, -0.30708661417322836, -0.2992125984251969, -0.29133858267716534, -0.28346456692913385, -0.2755905511811024, -0.2677165354330709, -0.25984251968503935, -0.25196850393700787, -0.2440944881889764, -0.23622047244094488, -0.2283464566929134, -0.2204724409448819, -0.2125984251968504, -0.2047244094488189, -0.1968503937007874, -0.1889763779527559, -0.18110236220472442, -0.1732283464566929, -0.16535433070866143, -0.15748031496062992, -0.14960629921259844, -0.14173228346456693, -0.13385826771653545, -0.12598425196850394, -0.11811023622047244, -0.11023622047244094, -0.10236220472440945, -0.09448818897637795, -0.08661417322834646, -0.07874015748031496, -0.07086614173228346, -0.06299212598425197, -0.05511811023622047, -0.047244094488188976, -0.03937007874015748, -0.031496062992125984, -0.023622047244094488, -0.015748031496062992, -0.007874015748031496, 0],
  separateChannels (view8) {
    const channelSize = view8.length * 0.25
    const channelR = new Uint8ClampedArray(channelSize)
    const channelG = new Uint8ClampedArray(channelSize)
    const channelB = new Uint8ClampedArray(channelSize)

    const len = view8.length
    for (let i = 0, j = 0; i < len; i += 4, j++) {
      channelR[j] = view8[i]
      channelG[j] = view8[i + 1]
      channelB[j] = view8[i + 2]
    }
    return [channelR, channelG, channelB]
  },
  getHistograms (data) {
    const histR = new Uint32Array(256)
    const histG = new Uint32Array(256)
    const histB = new Uint32Array(256)

    const len = data.length
    for (let i = 0; i < len; i += 4) {
      histR[data[i] & 0b11111111]++
      histG[data[i + 1] & 0xFF]++
      histB[data[i + 2] & 0xFF]++
    }

    const counts = [histR[0], histR[255], histG[0], histG[255], histB[0], histB[255]]

    const highestR = util.maxHistogramPoint(histR)
    const highestG = util.maxHistogramPoint(histG)
    const highestB = util.maxHistogramPoint(histB)

    const factorR = 100 / highestR
    const factorG = 100 / highestG
    const factorB = 100 / highestB

    for (let i = 0; i < 256; i++) {
      histR[i] = histR[i] > 0 ? util.clamp(histR[i] * factorR, 1, 100) : 0
      histG[i] = histG[i] > 0 ? util.clamp(histG[i] * factorG, 1, 100) : 0
      histB[i] = histB[i] > 0 ? util.clamp(histB[i] * factorB, 1, 100) : 0
    }
    return [histR, histG, histB, counts]
  },
  histogramEqualization (channel) {
    const counted = this.getCount(channel)
    const cdf = this.getCdf(counted)
    const min = util.minInArray(channel)
    const max = util.maxInArray(channel)
    this.equalizeLevel(channel, cdf, min, max)
    return channel
  },
  percentileStretch (channel, clipL, clipR) {
    const len = channel.length
    const curve = this.factors[0][2]
    const factor = 1 / (clipR - clipL) * 255
    for (let i = 0; i < len; i++) {
      channel[i] = (channel[i] * (1 - curve[channel[i]])) + (channel[i] - clipL) * factor * (curve[channel[i]])
      // channel[i] = ((channel[i] - clipL) / (clipR - clipL)) * 255
    }
  },
  getCount (channel) {
    const counted = new Uint32Array(256)
    const len = channel.length
    for (let i = 0; i < len; i++) {
      counted[channel[i]]++
    }
    return counted
  },
  getCdf (countedArray) {
    const cdf = new Uint32Array(countedArray)
    const len = countedArray.length
    for (let i = 1; i < len; i++) {
      cdf[i] += cdf[i - 1]
    }
    return cdf
  },
  equalizeLevel (channel, cdf, min, max) {
    // const factor = 1 / 255
    const len = channel.length
    for (let i = 0; i < len; i++) {
      channel[i] = Math.round((cdf[channel[i]] - cdf[min]) / (len - cdf[min]) * 255)
    }
  },
  getAutoClips (channel, limit, counted = null) {
    if (counted === null) {
      counted = this.getCount(channel)
    }
    const limitL = counted[0] + limit
    const limitR = counted[255] + limit
    // const limitL = limit
    // const limitR = limit
    let sumL = 0
    let sumR = 0
    let clipL = 0
    let clipR = 255
    for (let i = 0; i <= 255; i++) {
      sumL += counted[i]
      if (sumL <= limitL) {
        clipL = i
      } else {
        break
      }
    }
    for (let i = 255; i >= 0; i--) {
      sumR += counted[i]
      if (sumR <= limitR) {
        clipR = i
      } else {
        break
      }
    }
    return [clipL, clipR]
  },
  adaptativeSpread (channel, width, height, amount) {
    const squareSize = 8
    const totalBlocksX = Math.ceil(width / squareSize)
    const totalBlocksY = Math.ceil(height / squareSize)
    const totalSquares = totalBlocksX * totalBlocksY
    const blocks = Array(totalSquares)
    // Initialize blocks
    for (let i = 0; i < totalSquares; i++) {
      blocks[i] = new Uint8ClampedArray(squareSize * squareSize)
    }
    // Fill blocks
    let blockI = 0
    for (let blockY = 0; blockY < totalBlocksY; blockY++) {
      for (let blockX = 0; blockX < totalBlocksX; blockX++) {
        let squareIndex = 0
        for (let y = 0; y < squareSize; y++) {
          for (let x = 0; x < squareSize; x++, squareIndex++) {
            blocks[blockI][squareIndex] = channel[(blockY * squareSize * width + y * width) + (blockX * squareSize + x)]
          }
        }
        blockI++
      }
    }
    // Process
    const limit = Math.round(squareSize * squareSize * 0.001)
    for (let i = 0; i < totalSquares; i++) {
      let [clipL, clipR] = this.getAutoClips(blocks[i], limit)
      clipL = util.lerp(0, clipL, amount / 100)
      clipR = util.lerp(255, clipR, amount / 100)
      this.spread(blocks[i], clipL, clipR)
    }
    // Reassign
    blockI = 0
    for (let blockY = 0; blockY < totalBlocksY; blockY++) {
      for (let blockX = 0; blockX < totalBlocksX; blockX++) {
        let squareIndex = 0
        for (let y = 0; y < squareSize; y++) {
          for (let x = 0; x < squareSize; x++, squareIndex++) {
            channel[(blockY * squareSize * width + y * width) + (blockX * squareSize + x)] = blocks[blockI][squareIndex]
          }
        }
        blockI++
      }
    }
  },
  grayWorld (channels) {
    const meanR = util.mean(channels[0])
    const meanG = util.mean(channels[1])
    const meanB = util.mean(channels[2])

    const factorR = 128 / meanR
    const factorG = 128 / meanG
    const factorB = 128 / meanB

    const len = channels[0].length
    for (let i = 0; i < len; i++) {
      channels[0][i] *= factorR
      channels[1][i] *= factorG
      channels[2][i] *= factorB
    }
  },
  grayWorldLevels (channels) {
    // 0, 32, 64, 96, 128, 160, 192, 224, 255
    const levels = [
      [0, 32],
      [33, 96],
      [97, 160],
      [161, 224],
      [225, 255]
    ]
    const levelsLen = levels.length
    const meanR = util.rangedMean(channels[0], levels)
    const meanG = util.rangedMean(channels[1], levels)
    const meanB = util.rangedMean(channels[2], levels)

    console.log({ meanR }, { meanG }, { meanB })

    const factorR = Array(levelsLen)
    const factorG = Array(levelsLen)
    const factorB = Array(levelsLen)

    for (let i = 0; i < levelsLen; i++) {
      factorR[i] = levels[i][1] / meanR[i]
      factorG[i] = levels[i][1] / meanG[i]
      factorB[i] = levels[i][1] / meanB[i]
    }
    console.log({ factorR }, { factorG }, { factorB })

    const len = channels[0].length
    for (let i = 0; i < len; i++) {
      for (let j = 0; j < 5; j++) {
        if (channels[0][i] < levels[j][1]) {
          channels[0][i] *= factorR[j]
          break
        }
        if (channels[1][i] < levels[j][1]) {
          channels[1][i] *= factorG[j]
          break
        }
        if (channels[2][i] < levels[j][1]) {
          channels[2][i] *= factorB[j]
          break
        }
      }
    }
  },
  exposure (channel, amount) {
    // const newValue = oldValue * (Math.pow(2, amount))
    const len = channel.length
    let range
    if (amount > 0) {
      range = [0, 0.00030118130379575003, 0.001204543794827595, 0.002709543321309793, 0.004815273327803071, 0.007520465401290033, 0.010823490035219097, 0.014722357611058778, 0.01921471959676957, 0.02429786996147143, 0.029968746805456026, 0.03622393420456005, 0.043059664267791065, 0.050471819406963214, 0.05845593481697908, 0.06700720116526127, 0.07612046748871337, 0.08579024429646942, 0.09601070687655666, 0.10677569880448468, 0.11807873565164495, 0.12991300889128854, 0.14227138999972777, 0.15514643475029277, 0.16853038769745454, 0.18241518684841607, 0.19679246851935528, 0.21165357237339388, 0.22698954663726312, 0.24279115349351543, 0.2590488746450409, 0.275752917048533, 0.2928932188134523, 0.31045945526293284, 0.32844104515298134, 0.3468271570462229, 0.36560671583635473, 0.3847684094193734, 0.40430069550756675, 0.4241918085821548, 0.4444297669803978, 0.46500238011290274, 0.4858972558067781, 0.5071018077702157, 0.5286032631740021, 0.5503886703453931, 0.5724449065697175, 0.5947586859950105, 0.6173165676349104, 0.640104963465012, 0.66311014660778, 0.6863182596011085, 0.7097153227455375, 0.7332872425251014, 0.7570198200967359, 0.7808987598431298, 0.8049096779838713, 0.8290381112396983, 0.8532695255446385, 0.877589324800784, 0.9019828596704395, 0.9264354364003325, 0.9509323256725819, 0.9754587714770876, 0.9825475935627164, 0.9743682840496427, 0.9661906901228153, 0.9580153591263014, 0.9498428382527068, 0.9416736745065475, 0.933508414667642, 0.9253476052545103, 0.9171917924877956, 0.9090415222537063, 0.9008973400674752, 0.8927597910368508, 0.8846294198256084, 0.8765067706170968, 0.8683923870778155, 0.8602868123210232, 0.8521905888703893, 0.8441042586236791, 0.8360283628164837, 0.8279634419859966, 0.81991003593483, 0.8118686836948892, 0.8038399234912902, 0.7958242927063368, 0.7878223278435539, 0.7798345644917745, 0.7718615372892959, 0.7639037798880913, 0.7559618249180935, 0.7480362039515451, 0.740127447467418, 0.7322360848159066, 0.724362644183001, 0.716507652555129, 0.7086716356838891, 0.7008551180508563, 0.6930586228324798, 0.6852826718650664, 0.6775277856098498, 0.669794483118159, 0.6620832819966733, 0.6543946983727796, 0.6467292468600281, 0.639087440523685, 0.6314697908463951, 0.6238768076939445, 0.6163089992811358, 0.6087668721377725, 0.6012509310747537, 0.5937616791502891, 0.5862996176362252, 0.5788652459844957, 0.571459061793693, 0.5640815607757599, 0.556733236722814, 0.5494145814740945, 0.5421260848830431, 0.5348682347845186, 0.5276415169621418, 0.5204464151157846, 0.513283410829192, 0.5061529835377501, 0.4990556104963967, 0.4919917667476761, 0.48496192508994584, 0.4779665560457286, 0.47100612783022044, 0.46408110631995336, 0.45719195502161036, 0.45033913504100487, 0.4435231050522156, 0.43674432126688734, 0.43000323740369706, 0.42330030465798263, 0.41663597167154676, 0.41001068450262546, 0.4034248865960336, 0.3968790187534853, 0.3903735191040877, 0.3839088230750187, 0.3774853633623806, 0.3711035699022396, 0.3647638698418506, 0.3584666875110649, 0.3522124443939302, 0.3460015591004808, 0.3398344473387165, 0.3337115218867811, 0.3276331925653322, 0.3215998662101116, 0.3156119466447165, 0.30966983465356746, 0.30377392795508684, 0.29792462117507534, 0.2921223058203003, 0.2863673702522923, 0.2806601996613488, 0.27500117604075514, 0.269390678161215, 0.2638290815454989, 0.2583167584433109, 0.2528540778063709, 0.24744140526372238, 0.24207910309725766, 0.2367675302174711, 0.2315070421394364, 0.22629799095901104, 0.2211407253292681, 0.21603559043716325, 0.21098292798042895, 0.20598307614470257, 0.20103636958089333, 0.19614313938278294, 0.19130371306486227, 0.1865184145404135, 0.1817875640998282, 0.17711147838916985, 0.1724904703889789, 0.16792484939332664, 0.16341492098911214, 0.15896098703560757, 0.15456334564425656, 0.15022229115871966, 0.14593811413517177, 0.1417111013228578, 0.13754153564489746, 0.13342969617935008, 0.12937585814053298, 0.12538029286060415, 0.12144326777139913, 0.11756504638653087, 0.1137458882837542, 0.10998604908759058, 0.10628578045221726, 0.10264533004462639, 0.09906494152804601, 0.09554485454563211, 0.09208530470442744, 0.08868652355959372, 0.08534873859891245, 0.08207217322755733, 0.07885704675314342, 0.07570357437104724, 0.07261196715000273, 0.06958243201797543, 0.06661517174831122, 0.06371038494616499, 0.06086826603520612, 0.05808900524460758, 0.055372788596311784, 0.052719797892579856, 0.05013021070382384, 0.04760420035672175, 0.04514193592261484, 0.04274358220619312, 0.04040929973446383, 0.03813924474600727, 0.03593356918051838, 0.033792420668638745, 0.03171594252207455, 0.029704273724003527, 0.027757548919774444, 0.025875898407893505, 0.02405944813130323, 0.02230831966895397, 0.020622630227665306, 0.019002492634281, 0.017448015328118238, 0.015959302353709126, 0.014536453353836243, 0.013179563562863872, 0.011888723800363543, 0.010664020465035784, 0.009505535528926301, 0.008413346531940258, 0.007387526576652204, 0.0064281443234125435, 0.005535263985752881, 0.004708945326087566, 0.003949243651713674, 0.0032562098111089677, 0.0026298901905290606, 0.002070326710902348, 0.001577556825023918, 0.0011516135150493323, 0.0007925252902865054, 0.0005003161852876747, 0.0002750057582412424, 0.00011660908966160122, 0.00002513678138105213, 5.949558390394571e-7, 0.00004298525567314471]
    } else {
      range = [1, 0.996078431372549, 0.9921568627450981, 0.9882352941176471, 0.984313725490196, 0.9803921568627451, 0.9764705882352941, 0.9725490196078431, 0.9686274509803922, 0.9647058823529412, 0.9607843137254902, 0.9568627450980393, 0.9529411764705882, 0.9490196078431372, 0.9450980392156862, 0.9411764705882353, 0.9372549019607843, 0.9333333333333333, 0.9294117647058824, 0.9254901960784314, 0.9215686274509803, 0.9176470588235294, 0.9137254901960784, 0.9098039215686274, 0.9058823529411765, 0.9019607843137255, 0.8980392156862745, 0.8941176470588236, 0.8901960784313725, 0.8862745098039215, 0.8823529411764706, 0.8784313725490196, 0.8745098039215686, 0.8705882352941177, 0.8666666666666667, 0.8627450980392157, 0.8588235294117647, 0.8549019607843137, 0.8509803921568627, 0.8470588235294118, 0.8431372549019608, 0.8392156862745098, 0.8352941176470589, 0.8313725490196079, 0.8274509803921568, 0.8235294117647058, 0.8196078431372549, 0.8156862745098039, 0.8117647058823529, 0.807843137254902, 0.803921568627451, 0.8, 0.796078431372549, 0.792156862745098, 0.788235294117647, 0.7843137254901961, 0.7803921568627451, 0.7764705882352941, 0.7725490196078432, 0.7686274509803922, 0.7647058823529411, 0.7607843137254902, 0.7568627450980392, 0.7529411764705882, 0.7490196078431373, 0.7450980392156863, 0.7411764705882353, 0.7372549019607844, 0.7333333333333333, 0.7294117647058823, 0.7254901960784313, 0.7215686274509804, 0.7176470588235294, 0.7137254901960784, 0.7098039215686275, 0.7058823529411765, 0.7019607843137254, 0.6980392156862745, 0.6941176470588235, 0.6901960784313725, 0.6862745098039216, 0.6823529411764706, 0.6784313725490196, 0.6745098039215687, 0.6705882352941176, 0.6666666666666666, 0.6627450980392157, 0.6588235294117647, 0.6549019607843137, 0.6509803921568628, 0.6470588235294118, 0.6431372549019608, 0.6392156862745098, 0.6352941176470588, 0.6313725490196078, 0.6274509803921569, 0.6235294117647059, 0.6196078431372549, 0.615686274509804, 0.611764705882353, 0.6078431372549019, 0.6039215686274509, 0.6, 0.596078431372549, 0.592156862745098, 0.5882352941176471, 0.5843137254901961, 0.5803921568627451, 0.5764705882352941, 0.5725490196078431, 0.5686274509803921, 0.5647058823529412, 0.5607843137254902, 0.5568627450980392, 0.5529411764705883, 0.5490196078431373, 0.5450980392156862, 0.5411764705882353, 0.5372549019607843, 0.5333333333333333, 0.5294117647058824, 0.5254901960784314, 0.5215686274509804, 0.5176470588235295, 0.5137254901960784, 0.5098039215686274, 0.5058823529411764, 0.5019607843137255, 0.4980392156862745, 0.49411764705882355, 0.49019607843137253, 0.48627450980392156, 0.4823529411764706, 0.47843137254901963, 0.4745098039215686, 0.47058823529411764, 0.4666666666666667, 0.4627450980392157, 0.4588235294117647, 0.4549019607843137, 0.45098039215686275, 0.4470588235294118, 0.44313725490196076, 0.4392156862745098, 0.43529411764705883, 0.43137254901960786, 0.42745098039215684, 0.4235294117647059, 0.4196078431372549, 0.41568627450980394, 0.4117647058823529, 0.40784313725490196, 0.403921568627451, 0.4, 0.396078431372549, 0.39215686274509803, 0.38823529411764707, 0.3843137254901961, 0.3803921568627451, 0.3764705882352941, 0.37254901960784315, 0.3686274509803922, 0.36470588235294116, 0.3607843137254902, 0.3568627450980392, 0.35294117647058826, 0.34901960784313724, 0.34509803921568627, 0.3411764705882353, 0.33725490196078434, 0.3333333333333333, 0.32941176470588235, 0.3254901960784314, 0.3215686274509804, 0.3176470588235294, 0.3137254901960784, 0.30980392156862746, 0.3058823529411765, 0.30196078431372547, 0.2980392156862745, 0.29411764705882354, 0.2901960784313726, 0.28627450980392155, 0.2823529411764706, 0.2784313725490196, 0.27450980392156865, 0.27058823529411763, 0.26666666666666666, 0.2627450980392157, 0.25882352941176473, 0.2549019607843137, 0.25098039215686274, 0.24705882352941178, 0.24313725490196078, 0.23921568627450981, 0.23529411764705882, 0.23137254901960785, 0.22745098039215686, 0.2235294117647059, 0.2196078431372549, 0.21568627450980393, 0.21176470588235294, 0.20784313725490197, 0.20392156862745098, 0.2, 0.19607843137254902, 0.19215686274509805, 0.18823529411764706, 0.1843137254901961, 0.1803921568627451, 0.17647058823529413, 0.17254901960784313, 0.16862745098039217, 0.16470588235294117, 0.1607843137254902, 0.1568627450980392, 0.15294117647058825, 0.14901960784313725, 0.1450980392156863, 0.1411764705882353, 0.13725490196078433, 0.13333333333333333, 0.12941176470588237, 0.12549019607843137, 0.12156862745098039, 0.11764705882352941, 0.11372549019607843, 0.10980392156862745, 0.10588235294117647, 0.10196078431372549, 0.09803921568627451, 0.09411764705882353, 0.09019607843137255, 0.08627450980392157, 0.08235294117647059, 0.0784313725490196, 0.07450980392156863, 0.07058823529411765, 0.06666666666666667, 0.06274509803921569, 0.058823529411764705, 0.054901960784313725, 0.050980392156862744, 0.047058823529411764, 0.043137254901960784, 0.0392156862745098, 0.03529411764705882, 0.03137254901960784, 0.027450980392156862, 0.023529411764705882, 0.0196078431372549, 0.01568627450980392, 0.011764705882352941, 0.00784313725490196, 0.00392156862745098, 0]
    }
    for (let i = 0; i < len; i++) {
      // channel[i] += amount * range[channel[i]]
      channel[i] = channel[i] * (Math.pow(2, amount * 0.01))
    }
  },
  moveSection (channel, amount, range, interpolation, limitLeft = 0, limitRight = 255) {
    const len = channel.length
    const factors = this.factors[interpolation][range]
    for (let i = 0; i < len; i++) {
      channel[i] += amount * factors[channel[i]]
    }
  },
  changeCenter (channel, newMidPoint) {
    const factor = 127 - newMidPoint
    const len = channel.length
    let distance
    for (let i = 0; i < len; i++) {
      if (channel[i] <= newMidPoint) {
        distance = util.findPercentage(channel[i], 0, newMidPoint)
      } else {
        distance = util.findPercentage(channel[i], 255, newMidPoint)
      }
      channel[i] += factor * distance
    }
  },
  drawHistogram (ctx, histogram) {
    // const colors = [
    //   '#D32F2F', '#388E3C', '#1976D2', 'white'
    // ]
    ctx.beginPath()
    for (let i = 0; i <= 255; i++) {
      ctx.moveTo(i + 0.5, 100)
      ctx.lineTo(i + 0.5, 100 - histogram[i])
    }
    ctx.stroke()

    // ctx.strokeStyle = colors[colorIndex]
    // ctx.beginPath()

    // ctx.moveTo(0 + 0.5, 100)
    // ctx.lineTo(0 + 0.5, 100 - histogram[0])

    // ctx.moveTo(255 + 0.5, 100)
    // ctx.lineTo(255 + 0.5, 100 - histogram[255])

    // ctx.stroke()
    // ctx.strokeStyle = 'lightgrey'
    // ctx.beginPath
    // for (let i = 0; i < 256; i++) {

    // }
  },
  drawRGB (ctx, histR, histG, histB) {
    ctx.strokeStyle = '#D32F2F'
    ctx.beginPath()
    for (let i = 0; i < 256; i++) {
      // ctx.fillRect(i + 0.5, 100 - histR[i], 1, 100 - histR[i - 1])
      ctx.moveTo(i + 0.5, 100 - histR[i])
      ctx.lineTo(i + 0.5, 100 - histR[i - 1])
    }
    ctx.stroke()

    ctx.strokeStyle = '#388E3C'
    ctx.beginPath()
    for (let i = 0; i < 256; i++) {
      ctx.moveTo(i + 0.5, 100 - histG[i])
      ctx.lineTo(i + 0.5, 100 - histG[i - 1])
    }
    ctx.stroke()

    ctx.strokeStyle = '#1976D2'
    ctx.beginPath()
    for (let i = 0; i < 256; i++) {
      ctx.moveTo(i + 0.5, 100 - histB[i])
      ctx.lineTo(i + 0.5, 100 - histB[i - 1])
    }
    ctx.stroke()
  },
  RGBToHSL (r, g, b) {
    // Make r, g, and b fractions of 1
    r /= 255
    g /= 255
    b /= 255

    // Find greatest and smallest channel values
    const cmin = Math.min(r, g, b)
    const cmax = Math.max(r, g, b)
    const delta = cmax - cmin
    let h = 0
    let s = 0
    let l = 0

    // Calculate hue
    // No difference
    if (delta === 0) {
      h = 0
    } else if (cmax === r) {
      // Red is max
      h = ((g - b) / delta) % 6
    } else if (cmax === g) {
      // Green is max
      h = (b - r) / delta + 2
    } else {
      // Blue is max
      h = (r - g) / delta + 4
    }

    h = Math.round(h * 60)

    // Make negative hues positive behind 360°
    if (h < 0) { h += 360 }

    // Calculate lightness
    l = (cmax + cmin) * 0.5

    // Calculate saturation
    s = delta === 0 ? 0 : delta / (1 - Math.abs(2 * l - 1))

    // Multiply l and s by 100
    s = +(s * 100).toFixed(1)
    l = +(l * 100).toFixed(1)

    // return 'hsl(' + h + ',' + s + '%,' + l + '%)'
    return [h, s, l]
  },
  HSLToRGB (h, s, l) {
    // Must be fractions of 1
    s *= 0.01
    l *= 0.01

    const c = (1 - Math.abs(2 * l - 1)) * s
    const x = c * (1 - Math.abs((h / 60) % 2 - 1))
    const m = l - c * 0.5
    let r = 0
    let g = 0
    let b = 0
    if (h >= 0 && h < 60) {
      r = c
      g = x
      b = 0
    } else if (h >= 60 && h < 120) {
      r = x
      g = c
      b = 0
    } else if (h >= 120 && h < 180) {
      r = 0
      g = c
      b = x
    } else if (h >= 180 && h < 240) {
      r = 0
      g = x
      b = c
    } else if (h >= 240 && h < 300) {
      r = x
      g = 0
      b = c
    } else if (h >= 300 && h < 360) {
      r = c
      g = 0
      b = x
    }
    r = Math.round((r + m) * 255)
    g = Math.round((g + m) * 255)
    b = Math.round((b + m) * 255)
    return [r, g, b]
  },
  processImage (inImg) {
    // const width = inImg.width
    // const height = inImg.height
    const src = new Uint32Array(inImg.data.buffer)
    const isValueHistogram = true

    const histBrightness = (new Array(256)).fill(0)
    const histR = (new Array(256)).fill(0)
    const histG = (new Array(256)).fill(0)
    const histB = (new Array(256)).fill(0)

    for (let i = 0; i < src.length; i++) {
      const r = src[i] & 0xFF
      const g = (src[i] >> 8) & 0xFF
      const b = (src[i] >> 16) & 0xFF
      histBrightness[r]++
      histBrightness[g]++
      histBrightness[b]++
      histR[r]++
      histG[g]++
      histB[b]++
    }

    let maxBrightness = 0
    if (isValueHistogram) {
      for (let i = 1; i < 256; i++) {
        if (maxBrightness < histBrightness[i]) {
          maxBrightness = histBrightness[i]
        }
      }
    } else {
      for (let i = 0; i < 256; i++) {
        if (maxBrightness < histR[i]) {
          maxBrightness = histR[i]
        } else if (maxBrightness < histG[i]) {
          maxBrightness = histG[i]
        } else if (maxBrightness < histB[i]) {
          maxBrightness = histB[i]
        }
      }
    }

    const canvas = document.getElementById('canvasHistogram')
    const ctx = canvas.getContext('2d')
    const guideHeight = 8
    const startY = (canvas.height - guideHeight)
    const dx = canvas.width / 256
    const dy = startY / maxBrightness
    ctx.lineWidth = dx
    ctx.fillStyle = '#fff'
    ctx.fillRect(0, 0, canvas.width, canvas.height)

    for (let i = 0; i < 256; i++) {
      const x = i * dx
      if (isValueHistogram) {
        // Value
        ctx.strokeStyle = '#000000'
        ctx.beginPath()
        ctx.moveTo(x, startY)
        ctx.lineTo(x, startY - histBrightness[i] * dy)
        ctx.closePath()
        ctx.stroke()
      } else {
        // Red
        ctx.strokeStyle = 'rgba(220,0,0,0.5)'
        ctx.beginPath()
        ctx.moveTo(x, startY)
        ctx.lineTo(x, startY - histR[i] * dy)
        ctx.closePath()
        ctx.stroke()
        // Green
        ctx.strokeStyle = 'rgba(0,210,0,0.5)'
        ctx.beginPath()
        ctx.moveTo(x, startY)
        ctx.lineTo(x, startY - histG[i] * dy)
        ctx.closePath()
        ctx.stroke()
        // Blue
        ctx.strokeStyle = 'rgba(0,0,255,0.5)'
        ctx.beginPath()
        ctx.moveTo(x, startY)
        ctx.lineTo(x, startY - histB[i] * dy)
        ctx.closePath()
        ctx.stroke()
      }
      // Guide
      ctx.strokeStyle = 'rgb(' + i + ', ' + i + ', ' + i + ')'
      ctx.beginPath()
      ctx.moveTo(x, startY)
      ctx.lineTo(x, canvas.height)
      ctx.closePath()
      ctx.stroke()
    }
  },
  previewFast () {
    console.log('prev')
    const lowestPixel = this.lowestPixel
    const highestPixel = this.highestPixel

    const tempdata = this.tempData.data

    const canvas = this.getCurrentCanvas()
    const context = canvas.getContext('2d')
    const imageData = context.createImageData(canvas.width, canvas.height)
    const length = imageData.data.length

    const buf = new ArrayBuffer(length)
    const buf8 = new Uint8ClampedArray(buf)
    const data = new Uint32Array(buf)

    const shadowsValue = this.modalBrightness.controls[0].value
    const shadowsPeak = 0
    const shadowsOffset = (highestPixel - lowestPixel) / 5 / highestPixel

    const darksValue = this.modalBrightness.controls[1].value
    const darksPeak = 0.25
    const darksOffset = (highestPixel - lowestPixel) / 5 / highestPixel

    const midsValue = this.modalBrightness.controls[2].value
    const midsPeak = 0.5
    const midsOffset = (highestPixel - lowestPixel) / 5 / highestPixel

    const brightsValue = this.modalBrightness.controls[3].value
    const brightsPeak = 0.75
    const brightsOffset = (highestPixel - lowestPixel) / 5 / highestPixel

    const highlightsValue = this.modalBrightness.controls[4].value
    const highlightsPeak = 1
    const highlightsOffset = (highestPixel - lowestPixel) / 5 / highestPixel

    const divisor = 1 / 3 / highestPixel

    let r, g, b, average
    let shadowsToAdd, darksToAdd, midsToAdd, brightsToAdd, highlightsToAdd

    for (let i = 0, j = 0; i < length; i += 4, j++) {
      r = tempdata[i]
      g = tempdata[i + 1]
      b = tempdata[i + 2]

      average = (r + g + b) * divisor

      shadowsToAdd = this.calculateStrength(average, shadowsPeak, shadowsOffset) * shadowsValue
      darksToAdd = this.calculateStrength(average, darksPeak, darksOffset) * darksValue
      midsToAdd = this.calculateStrength(average, midsPeak, midsOffset) * midsValue
      brightsToAdd = this.calculateStrength(average, brightsPeak, brightsOffset) * brightsValue
      highlightsToAdd = this.calculateStrength(average, highlightsPeak, highlightsOffset) * highlightsValue

      const finalSum = shadowsToAdd + darksToAdd + midsToAdd + brightsToAdd + highlightsToAdd
      r += finalSum
      g += finalSum
      b += finalSum

      r = util.clamp(r, 0, 255)
      g = util.clamp(g, 0, 255)
      b = util.clamp(b, 0, 255)

      data[j] =
        (255 << 24) | // alpha
        (b << 16) | // blue
        (g << 8) | // green
        r // red
    }
    imageData.data.set(buf8)
    context.putImageData(imageData, 0, 0)
  }
}

export default histogram
